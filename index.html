<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>14ëª…ì˜ ë ˆì „ë“œ ì¹œêµ¬ë“¤ ğŸ»</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
            padding-bottom: 80px;
        }

        /* ë©”ì¸ ìŠ¤í¬ë¦° */
        .main-screen {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
        }

        .main-title {
            font-size: 2.5rem;
            font-weight: 900;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #f093fb);
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradient 3s ease infinite;
            margin-bottom: 1rem;
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .main-subtitle {
            font-size: 1.1rem;
            color: white;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        .enter-btn {
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: 700;
            border: none;
            border-radius: 50px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .enter-btn:active {
            transform: scale(0.95);
        }

        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
        .container {
            display: none;
            padding: 20px 15px;
            max-width: 100%;
            margin: 0 auto;
        }

        .container.active {
            display: block;
        }

        /* ìƒë‹¨ ë„¤ë¹„ */
        .top-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 15px 20px;
            z-index: 1000;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            display: none;
        }

        .top-nav.active {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.2rem;
            font-weight: 700;
            color: #333;
        }

        .menu-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 10px 0;
            border-top: 1px solid rgba(0,0,0,0.1);
            z-index: 1000;
            display: none;
        }

        .bottom-nav.active {
            display: block;
        }

        .nav-items {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px 12px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.75rem;
            color: #666;
        }

        .nav-item.active {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }

        .nav-item .icon {
            font-size: 1.2rem;
            margin-bottom: 2px;
        }

        /* ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .section {
            display: none;
            margin-top: 70px;
            margin-bottom: 20px;
        }

        .section.active {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: white;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        /* ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            backdrop-filter: blur(20px);
        }

        /* ì¹œêµ¬ ë¦¬ìŠ¤íŠ¸ */
        .friends-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .friend-item {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .friend-item:active {
            transform: scale(0.95);
        }

        .friend-emoji {
            font-size: 2.5rem;
            margin-bottom: 8px;
            display: block;
        }

        .friend-name {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .friend-status {
            font-size: 0.7rem;
            opacity: 0.8;
        }

        /* ìˆ ì¹œêµ¬ ì„¹ì…˜ */
        .drink-section {
            margin-bottom: 25px;
        }

        .drink-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .drink-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
        }

        .add-drink-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 8px 15px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
        }

        .drink-log {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .drink-date {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 8px;
        }

        .drink-participants {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 10px;
        }

        .participant-tag {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .drink-photo {
            width: 100%;
            max-height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin-top: 10px;
        }

        /* ì›”ê°„ í†µê³„ */
        .monthly-stats {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 15px;
            padding: 20px;
            color: white;
            margin-bottom: 20px;
        }

        .stats-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            text-align: center;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .stat-item {
            background: rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.8rem;
            opacity: 0.9;
        }

        /* ë­í‚¹ */
        .ranking-list {
            background: white;
            border-radius: 15px;
            overflow: hidden;
        }

        .ranking-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        .ranking-item:last-child {
            border-bottom: none;
        }

        .rank-number {
            font-size: 1.2rem;
            font-weight: 700;
            color: #ff6b6b;
            width: 30px;
        }

        .rank-emoji {
            font-size: 1.5rem;
            margin: 0 10px;
        }

        .rank-info {
            flex: 1;
        }

        .rank-name {
            font-weight: 600;
            margin-bottom: 2px;
        }

        .rank-count {
            font-size: 0.8rem;
            color: #666;
        }

        /* ê°¤ëŸ¬ë¦¬ */
        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .photo-item {
            aspect-ratio: 1;
            background: #f0f0f0;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            overflow: hidden;
        }

        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-placeholder {
            font-size: 1.5rem;
            color: #ccc;
        }

        /* ì…ë ¥ í¼ */
        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
            font-size: 0.9rem;
        }

        .input-group input,
        .input-group textarea,
        .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 1rem;
            background: white;
        }

        .input-group input:focus,
        .input-group textarea:focus,
        .input-group select:focus {
            outline: none;
            border-color: #4ecdc4;
        }

        /* ì¹œêµ¬ ì„ íƒ ì²´í¬ë°•ìŠ¤ */
        .friend-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }

        .friend-checkbox {
            display: flex;
            align-items: center;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .friend-checkbox.selected {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
        }

        .friend-checkbox input[type="checkbox"] {
            display: none;
        }

        .friend-checkbox .emoji {
            margin-right: 8px;
            font-size: 1.2rem;
        }

        .friend-checkbox .name {
            font-size: 0.8rem;
            font-weight: 500;
        }

        /* ë²„íŠ¼ */
        .btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
        }

        .btn:active {
            transform: scale(0.98);
        }

        /* íŒŒì¼ ì—…ë¡œë“œ */
        .file-upload {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .file-upload input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-upload-label {
            display: block;
            padding: 15px;
            background: #f8f9fa;
            border: 2px dashed #ddd;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-upload-label:hover {
            background: #e9ecef;
            border-color: #4ecdc4;
        }

        .file-upload-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #ccc;
        }

        .file-upload-text {
            font-size: 0.9rem;
            color: #666;
        }

        /* ëª¨ë‹¬ */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            overflow-y: auto;
        }

        .modal-content {
            background: white;
            margin: 20px;
            padding: 20px;
            border-radius: 15px;
            position: relative;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .modal-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #999;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 480px) {
            .main-title {
                font-size: 2rem;
            }
            
            .friends-list {
                grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }
        }

        /* ìˆ¨ê¹€ */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- ë©”ì¸ ìŠ¤í¬ë¦° -->
    <div class="main-screen" id="mainScreen">
        <h1 class="main-title">ğŸ» 14ëª…ì˜ ë ˆì „ë“œ</h1>
        <p class="main-subtitle">ìˆ ì¹œêµ¬ë“¤ì˜ ì¶”ì–µ ì €ì¥ì†Œ</p>
        <button class="enter-btn" onclick="enterSite()">ğŸš€ ë“¤ì–´ê°€ê¸°</button>
    </div>

    <!-- ìƒë‹¨ ë„¤ë¹„ -->
    <div class="top-nav" id="topNav">
        <div class="logo">ğŸ» ë ˆì „ë“œ</div>
        <button class="menu-btn" onclick="toggleMenu()">â˜°</button>
    </div>

    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
    <div class="container" id="mainContainer">
        
        <!-- ìˆ ì¹œêµ¬ ì„¹ì…˜ -->
        <div id="drinking" class="section active">
            <h2 class="section-title">ğŸ» ìˆ ì¹œêµ¬ ë¡œê·¸</h2>
            
            <!-- ì´ë²ˆë‹¬ í†µê³„ -->
            <div class="monthly-stats">
                <h3 class="stats-title">ğŸ† ì´ë²ˆë‹¬ ìˆ ì¹œêµ¬ ìˆœìœ„</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-number" id="myDrinkCount">0</div>
                        <div class="stat-label">ë‚´ ìŒì£¼ íšŸìˆ˜</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="topDrinkerCount">0</div>
                        <div class="stat-label">ìŒì£¼í‚¹ ê¸°ë¡</div>
                    </div>
                </div>
            </div>

            <!-- ë­í‚¹ -->
            <div class="card">
                <h3 style="margin-bottom: 15px; font-size: 1.1rem;">ğŸ¥‡ ì´ë²ˆë‹¬ ìŒì£¼í‚¹ ë­í‚¹</h3>
                <div class="ranking-list" id="drinkingRanking">
                    <!-- ë­í‚¹ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- ìµœê·¼ ìˆ ì¹œêµ¬ ë¡œê·¸ -->
            <div class="card">
                <div class="drink-header">
                    <h3 class="drink-title">ğŸ“ ìµœê·¼ ìˆ ì¹œêµ¬ ê¸°ë¡</h3>
                    <button class="add-drink-btn" onclick="openDrinkModal()">+ ì¶”ê°€</button>
                </div>
                <div id="drinkLogs">
                    <!-- ìˆ ì¹œêµ¬ ë¡œê·¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>

        <!-- ì¹œêµ¬ë“¤ ì„¹ì…˜ -->
        <div id="friends" class="section">
            <h2 class="section-title">ğŸ‘¥ 14ëª…ì˜ ë ˆì „ë“œë“¤</h2>
            
            <div class="card">
                <div class="friends-list" id="friendsList">
                    <!-- ì¹œêµ¬ë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>
            
            <!-- ì¹œêµ¬ë³„ ì‚¬ì§„ ì—…ë¡œë“œ -->
            <div class="card">
                <h3 style="margin-bottom: 15px;">ğŸ“¸ ì¹œêµ¬ ì‚¬ì§„ ì—…ë¡œë“œ</h3>
                <div class="input-group">
                    <label>ì¹œêµ¬ ì„ íƒ:</label>
                    <select id="friendPhotoSelect">
                        <option value="">ì¹œêµ¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                    </select>
                </div>
                <button class="btn btn-secondary" onclick="openFriendPhotoModal()">ğŸ“¸ ì¹œêµ¬ ì‚¬ì§„ ì¶”ê°€</button>
                
                <div id="friendPhotoGallery" style="margin-top: 20px;">
                    <!-- ì¹œêµ¬ë³„ ì‚¬ì§„ë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>

        // ê°¤ëŸ¬ë¦¬ ì„¹ì…˜
        <div id="gallery" class="section">
            <h2 class="section-title">ğŸ“¸ íˆ¬í‘œ ê°¤ëŸ¬ë¦¬</h2>
            
            <div class="card">
                <div class="drink-header">
                    <h3 class="drink-title">ğŸ† ì‚¬ì§„ íˆ¬í‘œ ë­í‚¹</h3>
                    <button class="add-drink-btn" onclick="openGalleryPhotoModal()">+ ì‚¬ì§„ ì¶”ê°€</button>
                </div>
                <div id="voteGallery">
                    <!-- íˆ¬í‘œ ì‚¬ì§„ë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>

        <!-- ëª…ì–¸ì§‘ ì„¹ì…˜ -->
        <div id="quotes" class="section">
            <h2 class="section-title">ğŸ’¬ ë ˆì „ë“œ ëª…ì–¸ì§‘</h2>
            
            <div class="card" id="quotesList">
                <!-- ëª…ì–¸ë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            
            <button class="btn btn-primary" onclick="openQuoteModal()">ğŸ’¬ ëª…ì–¸ ì¶”ê°€</button>
        </div>
    </div>

    <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
    <div class="bottom-nav" id="bottomNav">
        <div class="nav-items">
            <div class="nav-item active" onclick="showSection('drinking')">
                <span class="icon">ğŸ»</span>
                <span>ìˆ ì¹œêµ¬</span>
            </div>
            <div class="nav-item" onclick="showSection('friends')">
                <span class="icon">ğŸ‘¥</span>
                <span>ì¹œêµ¬ë“¤</span>
            </div>
            <div class="nav-item" onclick="showSection('gallery')">
                <span class="icon">ğŸ“¸</span>
                <span>ê°¤ëŸ¬ë¦¬</span>
            </div>
            <div class="nav-item" onclick="showSection('quotes')">
                <span class="icon">ğŸ’¬</span>
                <span>ëª…ì–¸ì§‘</span>
            </div>
        </div>
    </div>

    <!-- ìˆ ì¹œêµ¬ ì¶”ê°€ ëª¨ë‹¬ -->
    <div id="drinkModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ğŸ» ìˆ ì¹œêµ¬ ê¸°ë¡ ì¶”ê°€</h3>
                <button class="close-btn" onclick="closeDrinkModal()">&times;</button>
            </div>
            
            <div class="input-group">
                <label>ë‚ ì§œ:</label>
                <input type="date" id="drinkDate" />
            </div>
            
            <div class="input-group">
                <label>í•¨ê»˜ ë§ˆì‹  ì¹œêµ¬ë“¤:</label>
                <div class="friend-selector" id="friendSelector">
                    <!-- ì¹œêµ¬ ì„ íƒ ì²´í¬ë°•ìŠ¤ë“¤ì´ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>
            
            <div class="input-group">
                <label>ë©”ëª¨:</label>
                <textarea id="drinkMemo" placeholder="ì–´ë””ì„œ ë­˜ ë§ˆì…¨ëŠ”ì§€, ì¬ë°Œì—ˆë˜ ì¼ ë“±..."></textarea>
            </div>
            
            <div class="input-group">
                <label>ì‚¬ì§„ ì¶”ê°€:</label>
                <div class="file-upload">
                    <input type="file" id="drinkPhoto" accept="image/*" onchange="previewDrinkPhoto()" />
                    <label for="drinkPhoto" class="file-upload-label">
                        <div class="file-upload-icon">ğŸ“·</div>
                        <div class="file-upload-text">ì‚¬ì§„ì„ ì„ íƒí•˜ê±°ë‚˜ ì—¬ê¸°ì— ë“œë¡­í•˜ì„¸ìš”</div>
                    </label>
                </div>
                <div id="drinkPhotoPreview" class="hidden">
                    <img id="drinkPhotoImg" style="width: 100%; max-height: 200px; object-fit: cover; border-radius: 10px; margin-top: 10px;" />
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="addDrinkLog()">ğŸ» ê¸°ë¡í•˜ê¸°</button>
        </div>
    </div>

        <!-- íˆ¬í‘œ ê°¤ëŸ¬ë¦¬ ì‚¬ì§„ ì¶”ê°€ ëª¨ë‹¬ -->
    <div id="galleryPhotoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ğŸ“¸ íˆ¬í‘œ ì‚¬ì§„ ì¶”ê°€</h3>
                <button class="close-btn" onclick="closeGalleryPhotoModal()">&times;</button>
            </div>
            
            <div class="input-group">
                <label>ì‚¬ì§„ ì œëª©:</label>
                <input type="text" id="galleryPhotoTitle" placeholder="ì¬ë°ŒëŠ” ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”!" />
            </div>
            
            <div class="input-group">
                <label>ì‚¬ì§„:</label>
                <div class="file-upload">
                    <input type="file" id="votePhoto" accept="image/*" onchange="previewVotePhoto()" />
                    <label for="votePhoto" class="file-upload-label">
                        <div class="file-upload-icon">ğŸ“·</div>
                        <div class="file-upload-text">íˆ¬í‘œìš© ì‚¬ì§„ì„ ì„ íƒí•˜ì„¸ìš”</div>
                    </label>
                </div>
                <div id="votePhotoPreview" class="hidden">
                    <img id="votePhotoImg" style="width: 100%; max-height: 200px; object-fit: cover; border-radius: 10px; margin-top: 10px;" />
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="addVotePhoto()">ğŸ—³ï¸ íˆ¬í‘œ ì‚¬ì§„ ì¶”ê°€</button>
        </div>
    </div>

    <!-- ì¹œêµ¬ ì‚¬ì§„ ì¶”ê°€ ëª¨ë‹¬ -->
    <div id="friendPhotoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ğŸ“¸ ì¹œêµ¬ ì‚¬ì§„ ì¶”ê°€</h3>
                <button class="close-btn" onclick="closeFriendPhotoModal()">&times;</button>
            </div>
            
            <div class="input-group">
                <label>ì¹œêµ¬ ì„ íƒ:</label>
                <select id="selectedFriendForPhoto">
                    <option value="">ì¹œêµ¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                </select>
            </div>
            
            <div class="input-group">
                <label>ì‚¬ì§„ ì œëª©:</label>
                <input type="text" id="friendPhotoTitle" placeholder="ì‚¬ì§„ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”" />
            </div>
            
            <div class="input-group">
                <label>ì‚¬ì§„:</label>
                <div class="file-upload">
                    <input type="file" id="friendPhoto" accept="image/*" onchange="previewFriendPhoto()" />
                    <label for="friendPhoto" class="file-upload-label">
                        <div class="file-upload-icon">ğŸ“·</div>
                        <div class="file-upload-text">ì¹œêµ¬ ì‚¬ì§„ì„ ì„ íƒí•˜ì„¸ìš”</div>
                    </label>
                </div>
                <div id="friendPhotoPreview" class="hidden">
                    <img id="friendPhotoImg" style="width: 100%; max-height: 200px; object-fit: cover; border-radius: 10px; margin-top: 10px;" />
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="addFriendPhoto()">ğŸ“¸ ì‚¬ì§„ ì¶”ê°€</button>
        </div>
    </div>

    <!-- ëª…ì–¸ ì¶”ê°€ ëª¨ë‹¬ -->
    <div id="quoteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ğŸ’¬ ëª…ì–¸ ì¶”ê°€</h3>
                <button class="close-btn" onclick="closeQuoteModal()">&times;</button>
            </div>
            
            <div class="input-group">
                <label>ëª…ì–¸:</label>
                <textarea id="quoteText" placeholder="ë ˆì „ë“œ ë°œì–¸ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
            </div>
            
            <div class="input-group">
                <label>ë°œì–¸ì:</label>
                <select id="quoteSpeaker">
                    <option value="">ì¹œêµ¬ ì„ íƒ</option>
                </select>
            </div>
            
            <button class="btn btn-primary" onclick="addQuote()">ğŸ’¬ ì¶”ê°€í•˜ê¸°</button>
        </div>
    </div>

    <script>
        // ë°ì´í„° ì €ì¥ì†Œ (ë©”ëª¨ë¦¬ ë°©ì‹ - ì‹¤ì œ ë°°í¬ì‹œì—ëŠ” localStorage ì‚¬ìš©)
        let friendsData = [];
        let drinkLogs = [];
        let votePhotos = []; // íˆ¬í‘œìš© ì‚¬ì§„ë“¤
        let friendPhotos = []; // ì¹œêµ¬ë³„ ì‚¬ì§„ë“¤
        let quotes = [];
        
        // ë°ì´í„° ì €ì¥ í•¨ìˆ˜ë“¤ (ì‹¤ì œ ë°°í¬ì‹œì—ëŠ” localStorage ì‚¬ìš©)
        function saveData() {
            try {
                localStorage.setItem('friendsData', JSON.stringify(friendsData));
                localStorage.setItem('drinkLogs', JSON.stringify(drinkLogs));
                localStorage.setItem('votePhotos', JSON.stringify(votePhotos));
                localStorage.setItem('friendPhotos', JSON.stringify(friendPhotos));
                localStorage.setItem('quotes', JSON.stringify(quotes));
            } catch(e) {
                // localStorage ì‚¬ìš© ë¶ˆê°€ì‹œ ë¬´ì‹œ (í˜„ì¬ í™˜ê²½)
                console.log('localStorage ì‚¬ìš© ë¶ˆê°€ - ë©”ëª¨ë¦¬ì—ë§Œ ì €ì¥ë©ë‹ˆë‹¤');
            }
        }
        
        function loadData() {
            try {
                friendsData = JSON.parse(localStorage.getItem('friendsData')) || [];
                drinkLogs = JSON.parse(localStorage.getItem('drinkLogs')) || [];
                votePhotos = JSON.parse(localStorage.getItem('votePhotos')) || [];
                friendPhotos = JSON.parse(localStorage.getItem('friendPhotos')) || [];
                quotes = JSON.parse(localStorage.getItem('quotes')) || [];
            } catch(e) {
                // localStorage ì‚¬ìš© ë¶ˆê°€ì‹œ ê¸°ë³¸ê°’ ìœ ì§€
                console.log('localStorage ì‚¬ìš© ë¶ˆê°€ - ê¸°ë³¸ ë°ì´í„°ë¡œ ì‹œì‘í•©ë‹ˆë‹¤');
            }
        }

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            loadData(); // ë°ì´í„° ë¡œë“œ ì‹œë„
            initializeFriends();
            loadDrinkLogs();
            loadVoteGallery();
            loadFriendPhotos();
            loadQuotes();
            updateRanking();
            
            // ì˜¤ëŠ˜ ë‚ ì§œ ì„¤ì •
            document.getElementById('drinkDate').value = new Date().toISOString().split('T')[0];
        });

        // ì‚¬ì´íŠ¸ ì§„ì…
        function enterSite() {
            document.getElementById('mainScreen').style.display = 'none';
            document.getElementById('mainContainer').classList.add('active');
            document.getElementById('topNav').classList.add('active');
            document.getElementById('bottomNav').classList.add('active');
        }

        // í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°
        function goHome() {
            document.getElementById('mainScreen').style.display = 'flex';
            document.getElementById('mainContainer').classList.remove('active');
            document.getElementById('topNav').classList.remove('active');
            document.getElementById('bottomNav').classList.remove('active');
        }

        // ì„¹ì…˜ ì „í™˜
        function showSection(sectionName) {
            // ëª¨ë“  ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // ëª¨ë“  ë„¤ë¹„ ì•„ì´í…œ ë¹„í™œì„±í™”
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // ì„ íƒëœ ì„¹ì…˜ ë³´ì´ê¸°
            document.getElementById(sectionName).classList.add('active');
            
            // í•´ë‹¹ ë„¤ë¹„ ì•„ì´í…œ í™œì„±í™”
            event.target.closest('.nav-item').classList.add('active');
            
            // íŠ¹ì • ì„¹ì…˜ë³„ ì¶”ê°€ ë¡œì§
            if (sectionName === 'friends') {
                // ì¹œêµ¬ ì„ íƒ ë°•ìŠ¤ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                const select = document.getElementById('friendPhotoSelect');
                if (select) {
                    select.onchange = loadSelectedFriendPhotos;
                }
            }
        }

        // ì¹œêµ¬ ë°ì´í„° ì´ˆê¸°í™”
        function initializeFriends() {
            if (friendsData.length === 0) {
                const realFriends = [
                    { id: 1, nickname: 'YSN JOKER', emoji: 'ğŸƒ', realName: 'ê°•ì •í˜„' },
                    { id: 2, nickname: 'ë³µì¿ ë ˆ', emoji: 'ğŸ²', realName: 'ë³µì§€í˜„' },
                    { id: 3, nickname: 'ê°í•´í‚¹(ìˆ™ì£¼)', emoji: 'ğŸ¦ ', realName: 'ê³½ë„ìœ¤' },
                    { id: 4, nickname: 'ë…¸ì†Œë§¨', emoji: 'ğŸ¯', realName: 'ì‹¬ì¬í˜„' },
                    { id: 5, nickname: 'ì¾Œê±¸ê·¼ìœ¡ë§¨', emoji: 'ğŸ’ª', realName: 'ì–‘ê·œí˜„' },
                    { id: 6, nickname: '26ë…„ 4ì›”', emoji: 'ğŸ“…', realName: 'ì´í•™ì¤€' },
                    { id: 7, nickname: 'í¬ì¤€ì•„ ë„ˆë§Œ ë¯¿ëŠ”ë‹¤', emoji: 'ğŸ™', realName: 'í•œí¬ì¤€' },
                    { id: 8, nickname: 'ëˆ„êµ¬ì„¸ìš”', emoji: 'â“', realName: 'ì „ìƒí˜' },
                    { id: 9, nickname: 'ê³½ì• ì¸', emoji: 'ğŸ’•', realName: 'ë„ìœ¤' },
                    { id: 10, nickname: 'ë‚˜ê°€ì£¼ì„¸ìš”', emoji: 'ğŸšª', realName: 'ì—°ìˆ˜' },
                    { id: 11, nickname: 'ì² êµ¬', emoji: 'ğŸ”©', realName: 'ì´ì„œí˜„' },
                    { id: 12, nickname: 'í™©ëŒ€í‘œ', emoji: 'ğŸ‘”', realName: 'í™©ìŠ¹í•˜' },
                    { id: 13, nickname: 'ë¯¸ë‚˜ë¦¬', emoji: 'ğŸŒ¿', realName: 'ì–‘ì •í›„' },
                    { id: 14, nickname: 'ê°•ìˆœê±´', emoji: 'ğŸ—ï¸', realName: 'ê°•ìˆœê±´' }
                ];
                
                friendsData = realFriends;
                saveData(); // ë°ì´í„° ì €ì¥
            }
            
            loadFriends();
            generateFriendSelector();
            updateSelects();
        }

        // ì¹œêµ¬ ëª©ë¡ ë¡œë“œ
        function loadFriends() {
            const container = document.getElementById('friendsList');
            container.innerHTML = '';
            
            friendsData.forEach(friend => {
                const friendElement = document.createElement('div');
                friendElement.className = 'friend-item';
                friendElement.onclick = () => showFriendDetails(friend.id);
                
                const drinkCount = getDrinkCountForFriend(friend.id);
                
                friendElement.innerHTML = `
                    <span class="friend-emoji">${friend.emoji}</span>
                    <div class="friend-name">${friend.nickname}</div>
                    <div class="friend-status">ì´ë²ˆë‹¬ ${drinkCount}íšŒ</div>
                `;
                
                container.appendChild(friendElement);
            });
        }

        // ì¹œêµ¬ë³„ ìˆ ì¹œêµ¬ íšŸìˆ˜ ê³„ì‚°
        function getDrinkCountForFriend(friendId) {
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            
            return drinkLogs.filter(log => {
                const logDate = new Date(log.date);
                return logDate.getMonth() === currentMonth && 
                       logDate.getFullYear() === currentYear &&
                       log.participants.includes(friendId);
            }).length;
        }

        // ì¹œêµ¬ ì„ íƒê¸° ìƒì„±
        function generateFriendSelector() {
            const container = document.getElementById('friendSelector');
            container.innerHTML = '';
            
            friendsData.forEach(friend => {
                const friendOption = document.createElement('div');
                friendOption.className = 'friend-checkbox';
                friendOption.onclick = () => toggleFriendSelection(friend.id);
                
                friendOption.innerHTML = `
                    <input type="checkbox" id="friend_${friend.id}" value="${friend.id}">
                    <span class="emoji">${friend.emoji}</span>
                    <span class="name">${friend.nickname}</span>
                `;
                
                container.appendChild(friendOption);
            });
        }

        // ì¹œêµ¬ ì„ íƒ í† ê¸€
        function toggleFriendSelection(friendId) {
            const checkbox = document.getElementById(`friend_${friendId}`);
            const container = checkbox.parentElement;
            
            checkbox.checked = !checkbox.checked;
            container.classList.toggle('selected', checkbox.checked);
        }

        // ì…€ë ‰íŠ¸ ë°•ìŠ¤ ì—…ë°ì´íŠ¸
        function updateSelects() {
            const selects = ['quoteSpeaker', 'friendPhotoSelect', 'selectedFriendForPhoto'];
            
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (!select) return;
                
                const currentValue = select.value;
                
                // ê¸°ì¡´ ì˜µì…˜ ì œê±° (ì²« ë²ˆì§¸ ì˜µì…˜ ì œì™¸)
                while(select.children.length > 1) {
                    select.removeChild(select.lastChild);
                }
                
                // ì¹œêµ¬ë“¤ ì¶”ê°€
                friendsData.forEach(friend => {
                    const option = document.createElement('option');
                    option.value = friend.id;
                    option.textContent = friend.nickname;
                    select.appendChild(option);
                });
                
                select.value = currentValue;
            });
        }

        // íˆ¬í‘œ ê°¤ëŸ¬ë¦¬ ì‚¬ì§„ ëª¨ë‹¬ ì—´ê¸°
        function openGalleryPhotoModal() {
            document.getElementById('galleryPhotoModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        // íˆ¬í‘œ ê°¤ëŸ¬ë¦¬ ì‚¬ì§„ ëª¨ë‹¬ ë‹«ê¸°
        function closeGalleryPhotoModal() {
            document.getElementById('galleryPhotoModal').style.display = 'none';
            document.body.style.overflow = 'auto';
            resetVotePhotoForm();
        }

        // íˆ¬í‘œ ì‚¬ì§„ í¼ ë¦¬ì…‹
        function resetVotePhotoForm() {
            document.getElementById('galleryPhotoTitle').value = '';
            document.getElementById('votePhoto').value = '';
            document.getElementById('votePhotoPreview').classList.add('hidden');
        }

        // íˆ¬í‘œ ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸°
        function previewVotePhoto() {
            const file = document.getElementById('votePhoto').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('votePhotoImg').src = e.target.result;
                    document.getElementById('votePhotoPreview').classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        }

        // íˆ¬í‘œ ì‚¬ì§„ ì¶”ê°€
        function addVotePhoto() {
            const title = document.getElementById('galleryPhotoTitle').value;
            const photoFile = document.getElementById('votePhoto').files[0];
            
            if (!title || !photoFile) {
                alert('ì œëª©ê³¼ ì‚¬ì§„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const newVotePhoto = {
                    id: Date.now(),
                    title: title,
                    photo: e.target.result,
                    votes: 0,
                    voters: [], // ì¤‘ë³µ íˆ¬í‘œ ë°©ì§€
                    timestamp: new Date().toISOString()
                };
                
                votePhotos.unshift(newVotePhoto);
                saveData();
                
                loadVoteGallery();
                closeGalleryPhotoModal();
            };
            reader.readAsDataURL(photoFile);
        }

        // íˆ¬í‘œ ê°¤ëŸ¬ë¦¬ ë¡œë“œ
        function loadVoteGallery() {
            const container = document.getElementById('voteGallery');
            container.innerHTML = '';
            
            if (votePhotos.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #999; padding: 20px;">íˆ¬í‘œí•  ì‚¬ì§„ì´ ì—†ì–´ìš”! ì²« ì‚¬ì§„ì„ ì˜¬ë ¤ë³´ì„¸ìš” ğŸ“¸</p>';
                return;
            }
            
            // íˆ¬í‘œìˆœìœ¼ë¡œ ì •ë ¬
            const sortedPhotos = [...votePhotos].sort((a, b) => b.votes - a.votes);
            
            sortedPhotos.forEach((photo, index) => {
                const photoElement = document.createElement('div');
                photoElement.className = 'drink-log';
                photoElement.style.background = index === 0 ? 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)' : 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                photoElement.style.color = 'white';
                
                photoElement.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <h4 style="margin: 0;">${index + 1}ìœ„. ${photo.title}</h4>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="font-weight: 600;">â¤ï¸ ${photo.votes}</span>
                            <button onclick="votePhoto(${photo.id})" style="background: rgba(255,255,255,0.2); border: none; border-radius: 15px; padding: 5px 12px; color: white; font-size: 0.8rem; cursor: pointer;">íˆ¬í‘œ</button>
                        </div>
                    </div>
                    <img src="${photo.photo}" style="width: 100%; max-height: 250px; object-fit: cover; border-radius: 10px; cursor: pointer;" onclick="viewPhoto('${photo.photo}', '${photo.title}')">
                    <div style="text-align: right; font-size: 0.7rem; opacity: 0.8; margin-top: 5px;">
                        ${new Date(photo.timestamp).toLocaleDateString('ko-KR')}
                    </div>
                `;
                
                container.appendChild(photoElement);
            });
        }

        // ì‚¬ì§„ íˆ¬í‘œ
        function votePhoto(photoId) {
            const photo = votePhotos.find(p => p.id === photoId);
            if (photo) {
                // ê°„ë‹¨í•œ ì¤‘ë³µ íˆ¬í‘œ ë°©ì§€ (ì‹¤ì œë¡œëŠ” ì‚¬ìš©ì ID ê¸°ë°˜ìœ¼ë¡œ í•´ì•¼ í•¨)
                const voterId = 'user1'; // ì„ì‹œ ì‚¬ìš©ì ID
                if (photo.voters.includes(voterId)) {
                    alert('ì´ë¯¸ íˆ¬í‘œí•˜ì…¨ìŠµë‹ˆë‹¤!');
                    return;
                }
                
                photo.votes += 1;
                photo.voters.push(voterId);
                saveData();
                loadVoteGallery();
            }
        }

        // ì¹œêµ¬ ì‚¬ì§„ ëª¨ë‹¬ ì—´ê¸°
        function openFriendPhotoModal() {
            const selectedFriend = document.getElementById('friendPhotoSelect').value;
            if (!selectedFriend) {
                alert('ë¨¼ì € ì¹œêµ¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!');
                return;
            }
            
            document.getElementById('selectedFriendForPhoto').value = selectedFriend;
            document.getElementById('friendPhotoModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        // ì¹œêµ¬ ì‚¬ì§„ ëª¨ë‹¬ ë‹«ê¸°
        function closeFriendPhotoModal() {
            document.getElementById('friendPhotoModal').style.display = 'none';
            document.body.style.overflow = 'auto';
            resetFriendPhotoForm();
        }

        // ì¹œêµ¬ ì‚¬ì§„ í¼ ë¦¬ì…‹
        function resetFriendPhotoForm() {
            document.getElementById('friendPhotoTitle').value = '';
            document.getElementById('friendPhoto').value = '';
            document.getElementById('friendPhotoPreview').classList.add('hidden');
        }

        // ì¹œêµ¬ ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸°
        function previewFriendPhoto() {
            const file = document.getElementById('friendPhoto').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('friendPhotoImg').src = e.target.result;
                    document.getElementById('friendPhotoPreview').classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        }

        // ì¹œêµ¬ ì‚¬ì§„ ì¶”ê°€
        function addFriendPhoto() {
            const friendId = document.getElementById('selectedFriendForPhoto').value;
            const title = document.getElementById('friendPhotoTitle').value;
            const photoFile = document.getElementById('friendPhoto').files[0];
            
            if (!friendId || !title || !photoFile) {
                alert('ëª¨ë“  ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const newFriendPhoto = {
                    id: Date.now(),
                    friendId: parseInt(friendId),
                    title: title,
                    photo: e.target.result,
                    timestamp: new Date().toISOString()
                };
                
                friendPhotos.unshift(newFriendPhoto);
                saveData();
                
                loadFriendPhotos();
                closeFriendPhotoModal();
            };
            reader.readAsDataURL(photoFile);
        }

        // ì¹œêµ¬ ì‚¬ì§„ë“¤ ë¡œë“œ
        function loadFriendPhotos() {
            const selectedFriend = document.getElementById('friendPhotoSelect')?.value;
            const container = document.getElementById('friendPhotoGallery');
            
            if (!container) return;
            
            container.innerHTML = '';
            
            if (!selectedFriend) {
                container.innerHTML = '<p style="text-align: center; color: #999; padding: 20px;">ì¹œêµ¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!</p>';
                return;
            }
            
            const friendFacePtotos = friendPhotos.filter(photo => photo.friendId == selectedFriend);
            
            if (friendFacePtotos.length === 0) {
                const friend = friendsData.find(f => f.id == selectedFriend);
                container.innerHTML = `<p style="text-align: center; color: #999; padding: 20px;">${friend?.nickname}ì˜ ì‚¬ì§„ì´ ì—†ì–´ìš”!</p>`;
                return;
            }
            
            const gridContainer = document.createElement('div');
            gridContainer.className = 'photo-grid';
            
            friendFacePtotos.forEach(photo => {
                const photoElement = document.createElement('div');
                photoElement.className = 'photo-item';
                photoElement.onclick = () => viewPhoto(photo.photo, photo.title);
                
                photoElement.innerHTML = `<img src="${photo.photo}" alt="${photo.title}">`;
                gridContainer.appendChild(photoElement);
            });
            
            container.appendChild(gridContainer);
        }

        // ì¹œêµ¬ ì„ íƒì‹œ ì‚¬ì§„ ë¡œë“œ
        function loadSelectedFriendPhotos() {
            loadFriendPhotos();
        }

        // ê¸°ì¡´ í•¨ìˆ˜ë“¤ ì—…ë°ì´íŠ¸

        // ìˆ ì¹œêµ¬ ëª¨ë‹¬ ì—´ê¸°
        function openDrinkModal() {
            document.getElementById('drinkModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        // ìˆ ì¹œêµ¬ ëª¨ë‹¬ ë‹«ê¸°
        function closeDrinkModal() {
            document.getElementById('drinkModal').style.display = 'none';
            document.body.style.overflow = 'auto';
            resetDrinkForm();
        }

        // ìˆ ì¹œêµ¬ í¼ ë¦¬ì…‹
        function resetDrinkForm() {
            document.getElementById('drinkDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('drinkMemo').value = '';
            document.getElementById('drinkPhoto').value = '';
            document.getElementById('drinkPhotoPreview').classList.add('hidden');
            
            // ì¹œêµ¬ ì„ íƒ ë¦¬ì…‹
            document.querySelectorAll('.friend-checkbox').forEach(item => {
                item.classList.remove('selected');
                item.querySelector('input').checked = false;
            });
        }

        // ìˆ ì¹œêµ¬ ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸°
        function previewDrinkPhoto() {
            const file = document.getElementById('drinkPhoto').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('drinkPhotoImg').src = e.target.result;
                    document.getElementById('drinkPhotoPreview').classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        }

        // ìˆ ì¹œêµ¬ ê¸°ë¡ ì¶”ê°€
        function addDrinkLog() {
            const date = document.getElementById('drinkDate').value;
            const memo = document.getElementById('drinkMemo').value;
            const selectedFriends = Array.from(document.querySelectorAll('.friend-checkbox.selected input'))
                .map(input => parseInt(input.value));
            
            if (!date || selectedFriends.length === 0) {
                alert('ë‚ ì§œì™€ ì¹œêµ¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!');
                return;
            }
            
            const photoFile = document.getElementById('drinkPhoto').files[0];
            let photoData = null;
            
            if (photoFile) {
                // ì‹¤ì œ ì•±ì—ì„œëŠ” ì„œë²„ì— ì—…ë¡œë“œí•˜ê² ì§€ë§Œ, ì§€ê¸ˆì€ base64ë¡œ ì €ì¥
                const reader = new FileReader();
                reader.onload = function(e) {
                    photoData = e.target.result;
                    saveDrinkLog();
                };
                reader.readAsDataURL(photoFile);
            } else {
                saveDrinkLog();
            }
            
            function saveDrinkLog() {
                const newLog = {
                    id: Date.now(),
                    date: date,
                    participants: selectedFriends,
                    memo: memo,
                    photo: photoData,
                    timestamp: new Date().toISOString()
                };
                
                drinkLogs.unshift(newLog);
                saveData(); // localStorage ëŒ€ì‹  saveData í•¨ìˆ˜ ì‚¬ìš©
                
                loadDrinkLogs();
                updateRanking();
                loadFriends();
                closeDrinkModal();
            }
        }

        // ìˆ ì¹œêµ¬ ë¡œê·¸ ë¡œë“œ
        function loadDrinkLogs() {
            const container = document.getElementById('drinkLogs');
            container.innerHTML = '';
            
            if (drinkLogs.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #999; padding: 20px;">ì•„ì§ ìˆ ì¹œêµ¬ ê¸°ë¡ì´ ì—†ì–´ìš”! ì²« ê¸°ë¡ì„ ë‚¨ê²¨ë³´ì„¸ìš” ğŸ»</p>';
                return;
            }
            
            drinkLogs.slice(0, 10).forEach(log => {
                const logElement = document.createElement('div');
                logElement.className = 'drink-log';
                
                const participants = log.participants.map(id => {
                    const friend = friendsData.find(f => f.id === id);
                    return friend ? friend.nickname : 'ì•Œ ìˆ˜ ì—†ìŒ';
                });
                
                logElement.innerHTML = `
                    <div class="drink-date">${new Date(log.date).toLocaleDateString('ko-KR', { 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric',
                        weekday: 'short'
                    })}</div>
                    <div class="drink-participants">
                        ${participants.map(name => `<span class="participant-tag">${name}</span>`).join('')}
                    </div>
                    ${log.memo ? `<div style="margin-top: 8px; font-size: 0.9rem;">${log.memo}</div>` : ''}
                    ${log.photo ? `<img src="${log.photo}" class="drink-photo" onclick="viewPhoto('${log.photo}')">` : ''}
                `;
                
                container.appendChild(logElement);
            });
        }

        // ë­í‚¹ ì—…ë°ì´íŠ¸
        function updateRanking() {
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            
            // ì¹œêµ¬ë³„ ìˆ ì¹œêµ¬ íšŸìˆ˜ ê³„ì‚°
            const drinkCounts = friendsData.map(friend => {
                const count = getDrinkCountForFriend(friend.id);
                return {
                    friend: friend,
                    count: count
                };
            }).sort((a, b) => b.count - a.count);
            
            // ë­í‚¹ í‘œì‹œ
            const container = document.getElementById('drinkingRanking');
            container.innerHTML = '';
            
            drinkCounts.slice(0, 5).forEach((item, index) => {
                const rankElement = document.createElement('div');
                rankElement.className = 'ranking-item';
                
                const medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰', '4ï¸âƒ£', '5ï¸âƒ£'];
                
                rankElement.innerHTML = `
                    <div class="rank-number">${index + 1}</div>
                    <div class="rank-emoji">${item.friend.emoji}</div>
                    <div class="rank-info">
                        <div class="rank-name">${item.friend.nickname}</div>
                        <div class="rank-count">ì´ë²ˆë‹¬ ${item.count}íšŒ</div>
                    </div>
                    <div style="font-size: 1.5rem;">${medals[index] || 'ğŸ…'}</div>
                `;
                
                container.appendChild(rankElement);
            });
            
            // í†µê³„ ì—…ë°ì´íŠ¸
            const topCount = drinkCounts[0] ? drinkCounts[0].count : 0;
            document.getElementById('topDrinkerCount').textContent = topCount;
            
            // ë‚´ ìŒì£¼ íšŸìˆ˜ëŠ” ì„ì˜ë¡œ ì²« ë²ˆì§¸ ì¹œêµ¬ë¡œ ì„¤ì • (ì‹¤ì œë¡œëŠ” ì‚¬ìš©ì ì„¤ì • í•„ìš”)
            document.getElementById('myDrinkCount').textContent = drinkCounts[0] ? drinkCounts[0].count : 0;
        }

        // ì‚¬ì§„ ëª¨ë‹¬ ì—´ê¸°
        function openPhotoModal() {
            document.getElementById('photoModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        // ì‚¬ì§„ ëª¨ë‹¬ ë‹«ê¸°
        function closePhotoModal() {
            document.getElementById('photoModal').style.display = 'none';
            document.body.style.overflow = 'auto';
            resetPhotoForm();
        }

        // ì‚¬ì§„ í¼ ë¦¬ì…‹
        function resetPhotoForm() {
            document.getElementById('photoTitle').value = '';
            document.getElementById('photoFriendSelect').value = '';
            document.getElementById('galleryPhoto').value = '';
            document.getElementById('galleryPhotoPreview').classList.add('hidden');
        }

        // ê°¤ëŸ¬ë¦¬ ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸°
        function previewGalleryPhoto() {
            const file = document.getElementById('galleryPhoto').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('galleryPhotoImg').src = e.target.result;
                    document.getElementById('galleryPhotoPreview').classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        }

        // ì‚¬ì§„ ì¶”ê°€
        function addPhoto() {
            const title = document.getElementById('photoTitle').value;
            const friendId = document.getElementById('photoFriendSelect').value;
            const photoFile = document.getElementById('galleryPhoto').files[0];
            
            if (!title || !photoFile) {
                alert('ì œëª©ê³¼ ì‚¬ì§„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const newPhoto = {
                    id: Date.now(),
                    title: title,
                    friendId: friendId ? parseInt(friendId) : null,
                    photo: e.target.result,
                    timestamp: new Date().toISOString()
                };
                
                photos.unshift(newPhoto);
                saveData(); // localStorage ëŒ€ì‹  saveData í•¨ìˆ˜ ì‚¬ìš©
                
                loadPhotos();
                closePhotoModal();
            };
            reader.readAsDataURL(photoFile);
        }

        // ì‚¬ì§„ ë¡œë“œ
        function loadPhotos() {
            const container = document.getElementById('photoGrid');
            container.innerHTML = '';
            
            const selectedFriend = document.getElementById('galleryFriendSelect')?.value;
            const filteredPhotos = selectedFriend ? 
                photos.filter(photo => photo.friendId == selectedFriend) : 
                photos;
            
            if (filteredPhotos.length === 0) {
                container.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: #999; padding: 20px;">ì‚¬ì§„ì´ ì—†ì–´ìš”!</p>';
                return;
            }
            
            filteredPhotos.forEach(photo => {
                const photoElement = document.createElement('div');
                photoElement.className = 'photo-item';
                photoElement.onclick = () => viewPhoto(photo.photo, photo.title);
                
                photoElement.innerHTML = `<img src="${photo.photo}" alt="${photo.title}">`;
                container.appendChild(photoElement);
            });
        }

        // ì¹œêµ¬ ê°¤ëŸ¬ë¦¬ ë¡œë“œ
        function loadFriendGallery() {
            loadPhotos();
        }

        // ì‚¬ì§„ í¬ê²Œ ë³´ê¸°
        function viewPhoto(photoSrc, title = '') {
            // ê°„ë‹¨í•œ ì‚¬ì§„ ë·°ì–´ (ëª¨ë‹¬ë¡œ êµ¬í˜„ ê°€ëŠ¥)
            const newWindow = window.open('', '_blank');
            newWindow.document.write(`
                <html>
                    <head><title>${title}</title></head>
                    <body style="margin:0; background:#000; display:flex; justify-content:center; align-items:center; min-height:100vh;">
                        <img src="${photoSrc}" style="max-width:100%; max-height:100vh; object-fit:contain;">
                    </body>
                </html>
            `);
        }

        // ëª…ì–¸ ëª¨ë‹¬ ì—´ê¸°
        function openQuoteModal() {
            document.getElementById('quoteModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        // ëª…ì–¸ ëª¨ë‹¬ ë‹«ê¸°
        function closeQuoteModal() {
            document.getElementById('quoteModal').style.display = 'none';
            document.body.style.overflow = 'auto';
            resetQuoteForm();
        }

        // ëª…ì–¸ í¼ ë¦¬ì…‹
        function resetQuoteForm() {
            document.getElementById('quoteText').value = '';
            document.getElementById('quoteSpeaker').value = '';
        }

        // ëª…ì–¸ ì¶”ê°€
        function addQuote() {
            const text = document.getElementById('quoteText').value;
            const speakerId = document.getElementById('quoteSpeaker').value;
            
            if (!text || !speakerId) {
                alert('ëª…ì–¸ê³¼ ë°œì–¸ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }
            
            const speaker = friendsData.find(f => f.id == speakerId);
            
            const newQuote = {
                id: Date.now(),
                text: text,
                speaker: speaker.nickname,
                speakerId: speakerId,
                timestamp: new Date().toISOString()
            };
            
            quotes.unshift(newQuote);
            saveData(); // localStorage ëŒ€ì‹  saveData í•¨ìˆ˜ ì‚¬ìš©
            
            loadQuotes();
            closeQuoteModal();
        }

        // ëª…ì–¸ ë¡œë“œ
        function loadQuotes() {
            const container = document.getElementById('quotesList');
            container.innerHTML = '';
            
            if (quotes.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #999; padding: 20px;">ì•„ì§ ëª…ì–¸ì´ ì—†ì–´ìš”! ì²« ëª…ì–¸ì„ ë‚¨ê²¨ë³´ì„¸ìš” ğŸ’¬</p>';
                return;
            }
            
            quotes.forEach(quote => {
                const quoteElement = document.createElement('div');
                quoteElement.className = 'drink-log';
                quoteElement.style.background = 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)';
                quoteElement.style.color = 'white';
                
                quoteElement.innerHTML = `
                    <div style="font-style: italic; font-size: 1.1rem; margin-bottom: 10px;">
                        "${quote.text}"
                    </div>
                    <div style="text-align: right; font-weight: 600;">
                        - ${quote.speaker}
                    </div>
                    <div style="text-align: right; font-size: 0.8rem; opacity: 0.8; margin-top: 5px;">
                        ${new Date(quote.timestamp).toLocaleDateString('ko-KR')}
                    </div>
                `;
                
                container.appendChild(quoteElement);
            });
        }

        // ì¹œêµ¬ ìƒì„¸ ì •ë³´ (ì¶”í›„ êµ¬í˜„)
        function showFriendDetails(friendId) {
            const friend = friendsData.find(f => f.id === friendId);
            alert(`${friend.nickname} (${friend.realName})\nì´ë²ˆë‹¬ ìˆ ì¹œêµ¬ íšŸìˆ˜: ${getDrinkCountForFriend(friendId)}íšŒ`);
        }

        // ë©”ë‰´ í† ê¸€ (ì¶”í›„ êµ¬í˜„)
        function toggleMenu() {
            // ì„¤ì • ë©”ë‰´ ë“± ì¶”ê°€ ê¸°ëŠ¥
            alert('ì¶”ê°€ ê¸°ëŠ¥ì€ ê³§ ì—…ë°ì´íŠ¸ ì˜ˆì •ì…ë‹ˆë‹¤!');
        }

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ì‹œ ë‹«ê¸°
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
        }
    </script>
</body>
</html>