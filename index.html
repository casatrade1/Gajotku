<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°€ì¡°ì¿  - ì¹œêµ¬ë“¤ë§Œì˜ SNS</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #fafafa;
            color: #262626;
        }

        /* ë¡œê·¸ì¸ í™”ë©´ */
        .login-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-box {
            background: white;
            border: 1px solid #dbdbdb;
            border-radius: 12px;
            padding: 40px;
            max-width: 400px;
            width: 100%;
            text-align: center;
        }

        .logo {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #405de6, #5851db, #833ab4, #c13584, #e1306c, #fd1d1d);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .friend-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .friend-card {
            background: #f8f9fa;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .friend-card:hover {
            border-color: #405de6;
            background: #f0f2ff;
        }

        .friend-card.selected {
            border-color: #405de6;
            background: #405de6;
            color: white;
        }

        .friend-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .friend-birthday {
            font-size: 12px;
            opacity: 0.7;
        }

        .login-btn {
            background: #405de6;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 30px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            width: 100%;
        }

        .login-btn:hover {
            background: #3449d1;
        }

        .login-btn:disabled {
            background: #c7c7c7;
            cursor: not-allowed;
        }

        /* ë©”ì¸ ì•± í™”ë©´ */
        .main-app {
            display: none;
            max-width: 480px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
        }

        /* ìƒì¼ ì•Œë¦¼ ë  */
        .birthday-banner {
            background: #262626;
            color: white;
            padding: 8px 16px;
            text-align: center;
            font-size: 12px;
            font-weight: 500;
        }

        /* í—¤ë” */
        .header {
            background: white;
            border-bottom: 1px solid #dbdbdb;
            padding: 10px 16px;
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header-title {
            font-size: 24px;
            font-weight: bold;
            font-family: 'Billabong', cursive;
        }

        .header-icons {
            display: flex;
            gap: 16px;
        }

        .icon-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            padding: 4px;
        }

        /* ë„¤ë¹„ê²Œì´ì…˜ ë°” */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 480px;
            background: white;
            border-top: 1px solid #dbdbdb;
            display: flex;
            padding: 8px 0;
            z-index: 100;
        }

        .nav-item {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 8px;
            cursor: pointer;
            font-size: 24px;
            color: #262626;
            transition: all 0.2s;
        }

        .nav-item.active {
            color: #405de6;
        }

        /* ì»¨í…ì¸  ì˜ì—­ */
        .content {
            padding-bottom: 60px; /* í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ê³µê°„ */
            min-height: calc(100vh - 100px);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* ì¸ìŠ¤íƒ€ í¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        .post {
            background: white;
            border: 1px solid #dbdbdb;
            margin-bottom: 16px;
        }

        .post-header {
            padding: 12px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .post-user {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .profile-pic {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(45deg, #405de6, #5851db, #833ab4, #c13584);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }

        .user-info h4 {
            font-size: 14px;
            font-weight: 600;
            margin: 0;
        }

        .post-time {
            font-size: 11px;
            color: #8e8e8e;
        }

        .post-image {
            width: 100%;
            max-height: 400px;
            object-fit: cover;
            display: block;
        }

        .post-actions {
            padding: 8px 16px;
            display: flex;
            gap: 16px;
            align-items: center;
        }

        .action-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            padding: 4px;
            color: #262626;
            transition: all 0.2s;
        }

        .action-btn.liked {
            color: #ed4956;
        }

        .post-likes {
            padding: 0 16px;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .post-content {
            padding: 0 16px 12px;
            font-size: 14px;
            line-height: 1.4;
        }

        .post-content .username {
            font-weight: 600;
            margin-right: 8px;
        }

        /* í¬ìŠ¤íŠ¸ ì‘ì„± */
        .create-post {
            background: white;
            border: 1px solid #dbdbdb;
            margin: 16px;
            border-radius: 12px;
            padding: 16px;
        }

        .create-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .create-input {
            width: 100%;
            border: none;
            font-size: 14px;
            resize: none;
            outline: none;
            min-height: 60px;
            margin-bottom: 12px;
        }

        .create-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .attach-btn {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #8e8e8e;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .post-btn {
            background: #405de6;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
        }

        .post-btn:disabled {
            background: #c7c7c7;
            cursor: not-allowed;
        }

        /* ì´ë¯¸ì§€ í”„ë¦¬ë·° */
        .image-preview {
            position: relative;
            margin: 12px 0;
        }

        .preview-img {
            width: 100%;
            max-height: 300px;
            object-fit: cover;
            border-radius: 8px;
        }

        .remove-img {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(0,0,0,0.7);
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            font-size: 12px;
        }

        /* í¬ìŠ¤íŠ¸ íƒ€ì… ì„ íƒ */
        .post-type {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
        }

        .type-btn {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #dbdbdb;
            background: white;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .type-btn.active {
            background: #405de6;
            color: white;
            border-color: #405de6;
        }

        .meeting-selector {
            display: none;
            margin-bottom: 12px;
        }

        .meeting-selector.active {
            display: block;
        }

        select {
            width: 100%;
            padding: 12px;
            border: 1px solid #dbdbdb;
            border-radius: 8px;
            font-size: 14px;
        }

        /* ë­í‚¹ */
        .ranking-section {
            margin: 16px;
        }

        .ranking-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
        }

        .ranking-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 16px;
            text-align: center;
        }

        .ranking-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .ranking-item:last-child {
            border-bottom: none;
        }

        .rank-position {
            font-weight: bold;
            font-size: 18px;
            width: 30px;
        }

        /* í”„ë¡œí•„ í˜ì´ì§€ */
        .profile-header {
            padding: 20px 16px;
            text-align: center;
            background: white;
            border-bottom: 1px solid #dbdbdb;
        }

        .profile-pic-large {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(45deg, #405de6, #5851db, #833ab4, #c13584);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 24px;
            margin: 0 auto 16px;
        }

        .profile-name {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .profile-stats {
            display: flex;
            justify-content: center;
            gap: 24px;
            margin-top: 16px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 18px;
            font-weight: bold;
            display: block;
        }

        .stat-label {
            font-size: 12px;
            color: #8e8e8e;
        }

        /* ëª¨ë‹¬ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 400px;
            width: 90%;
            max-height: 80%;
            overflow-y: auto;
        }

        .modal-header {
            padding: 16px;
            border-bottom: 1px solid #dbdbdb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 16px;
            font-weight: bold;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
        }

        .modal-body {
            padding: 16px;
        }

        /* ì‚­ì œ ë²„íŠ¼ */
        .delete-btn {
            color: #ed4956;
            background: none;
            border: none;
            font-size: 12px;
            cursor: pointer;
            padding: 4px;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 480px) {
            .friend-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* ìˆ¨ê¹€ íŒŒì¼ ì…ë ¥ */
        .hidden-file-input {
            display: none;
        }
    </style>
</head>
<body>
    <!-- ë¡œê·¸ì¸ í™”ë©´ -->
    <div id="loginScreen" class="login-screen">
        <div class="login-box">
            <div class="logo">ê°€ì¡°ì¿ </div>
            <p style="margin-bottom: 30px; color: #8e8e8e;">ì¹œêµ¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</p>
            
            <div class="friend-grid" id="friendGrid">
                <!-- ì¹œêµ¬ ëª©ë¡ì´ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
            </div>
            
            <button class="login-btn" id="loginBtn" disabled>ì…ì¥í•˜ê¸°</button>
        </div>
    </div>

    <!-- ë©”ì¸ ì•± í™”ë©´ -->
    <div id="mainApp" class="main-app">
        <!-- ìƒì¼ ì•Œë¦¼ ë  -->
        <div id="birthdayBanner" class="birthday-banner"></div>

        <!-- í—¤ë” -->
        <div class="header">
            <div class="header-title">ê°€ì¡°ì¿ </div>
            <div class="header-icons">
                <button class="icon-btn" onclick="openCreateModal()">â•</button>
                <button class="icon-btn" onclick="showProfile()">ğŸ‘¤</button>
            </div>
        </div>

        <!-- ì»¨í…ì¸  ì˜ì—­ -->
        <div class="content">
            <!-- í™ˆ í”¼ë“œ -->
            <div id="home" class="tab-content active">
                <!-- í¬ìŠ¤íŠ¸ ì‘ì„± -->
                <div class="create-post">
                    <div class="create-header">
                        <div class="profile-pic" id="createProfilePic"></div>
                        <div style="flex: 1;">
                            <div class="post-type">
                                <button class="type-btn active" data-type="diary" onclick="selectPostType('diary')">ğŸ“ ì¼ê¸°</button>
                                <button class="type-btn" data-type="meeting" onclick="selectPostType('meeting')">ğŸ‘¥ ë§Œë‚¨</button>
                            </div>
                        </div>
                    </div>
                    
                    <textarea class="create-input" id="postContent" placeholder="ì˜¤ëŠ˜ ì–´ë–¤ í•˜ë£¨ë¥¼ ë³´ë‚´ì…¨ë‚˜ìš”?"></textarea>
                    
                    <div class="meeting-selector" id="meetingSelector">
                        <select id="meetingPartner">
                            <option value="">ë§Œë‚œ ì¹œêµ¬ ì„ íƒ</option>
                        </select>
                    </div>
                    
                    <div id="imagePreview"></div>
                    
                    <div class="create-actions">
                        <button class="attach-btn" onclick="document.getElementById('imageInput').click()">
                            ğŸ“· ì‚¬ì§„ ì²¨ë¶€
                        </button>
                        <button class="post-btn" onclick="createPost()">ê²Œì‹œ</button>
                    </div>
                    
                    <input type="file" id="imageInput" class="hidden-file-input" accept="image/*" onchange="previewImage(this)">
                </div>

                <!-- í¬ìŠ¤íŠ¸ í”¼ë“œ -->
                <div id="postFeed"></div>
            </div>

            <!-- ë­í‚¹ íƒ­ -->
            <div id="ranking" class="tab-content">
                <div class="ranking-section" id="rankingContent"></div>
            </div>

            <!-- í”„ë¡œí•„ íƒ­ -->
            <div id="profile" class="tab-content">
                <div class="profile-header">
                    <div class="profile-pic-large" id="profilePicLarge"></div>
                    <div class="profile-name" id="profileName"></div>
                    <div class="profile-stats">
                        <div class="stat-item">
                            <span class="stat-number" id="postCount">0</span>
                            <span class="stat-label">ê²Œì‹œë¬¼</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number" id="meetingCount">0</span>
                            <span class="stat-label">ë§Œë‚¨</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number" id="likeCount">0</span>
                            <span class="stat-label">ì¢‹ì•„ìš”</span>
                        </div>
                    </div>
                </div>
                <div id="myPosts"></div>
            </div>
        </div>

        <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="bottom-nav">
            <div class="nav-item active" data-tab="home" onclick="switchTab('home')">ğŸ </div>
            <div class="nav-item" data-tab="ranking" onclick="switchTab('ranking')">ğŸ†</div>
            <div class="nav-item" data-tab="profile" onclick="switchTab('profile')">ğŸ‘¤</div>
        </div>
    </div>

    <!-- ì¢‹ì•„ìš” ëª©ë¡ ëª¨ë‹¬ -->
    <div id="likesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">ì¢‹ì•„ìš”</div>
                <button class="close-btn" onclick="closeLikesModal()">&times;</button>
            </div>
            <div class="modal-body" id="likesModalBody"></div>
        </div>
    </div>

    <script>
        // ì¹œêµ¬ ë°ì´í„°
        const friends = [
            { name: "í™©ìŠ¹í•˜", birthday: "2001-07-11" },
            { name: "ì´ì„œí˜„", birthday: "2001-01-24" },
            { name: "í•œí¬ì¤€", birthday: "2001-12-21" },
            { name: "ë³µì§€í˜„", birthday: "2001-01-15" },
            { name: "ì–‘ì •í›„", birthday: "2001-10-18" },
            { name: "ìœ¤í¬íƒœ", birthday: "2001-10-15" },
            { name: "ê³½ë„ìœ¤", birthday: "2001-07-31" },
            { name: "ê°•ìˆœê±´", birthday: "2001-04-18" },
            { name: "ì–‘ê·œí˜„", birthday: "2001-04-19" },
            { name: "ì´í•™ì¤€", birthday: "2002-02-22" },
            { name: "ê°•ì •í˜„", birthday: "2001-08-07" },
            { name: "ë°•ì£¼í˜¸", birthday: "2001-06-01" },
            { name: "ì „ìƒí˜", birthday: "2001-08-18" },
            { name: "ì‹¬ì¬í˜„", birthday: "2001-10-05" },
            { name: "ì‹ ë¯¼í˜¸", birthday: "2001-03-03" }
        ];

        let currentUser = null;
        let selectedFriend = null;
        let selectedPostType = 'diary';
        let currentImageData = null;

        // ë°ì´í„° ì €ì¥ì†Œ
        let posts = JSON.parse(localStorage.getItem('posts') || '[]');

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            renderFriendGrid();
            setupEventListeners();
        });

        function renderFriendGrid() {
            const grid = document.getElementById('friendGrid');
            grid.innerHTML = friends.map(friend => `
                <div class="friend-card" data-name="${friend.name}" onclick="selectFriend('${friend.name}')">
                    <div class="friend-name">${friend.name}</div>
                    <div class="friend-birthday">${formatBirthday(friend.birthday)}</div>
                </div>
            `).join('');
        }

        function selectFriend(name) {
            document.querySelectorAll('.friend-card').forEach(card => {
                card.classList.remove('selected');
            });

            const selectedCard = document.querySelector(`[data-name="${name}"]`);
            selectedCard.classList.add('selected');
            selectedFriend = name;

            document.getElementById('loginBtn').disabled = false;
        }

        function setupEventListeners() {
            document.getElementById('loginBtn').addEventListener('click', login);
        }

        function login() {
            if (!selectedFriend) return;
            
            currentUser = selectedFriend;
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            
            initializeApp();
        }

        function initializeApp() {
            setupSelectOptions();
            updateProfilePics();
            renderBirthdayBanner();
            renderPostFeed();
            renderRanking();
            renderProfile();
        }

        function setupSelectOptions() {
            const meetingSelect = document.getElementById('meetingPartner');
            const options = friends
                .filter(f => f.name !== currentUser)
                .map(f => `<option value="${f.name}">${f.name}</option>`)
                .join('');
            
            meetingSelect.innerHTML = '<option value="">ë§Œë‚œ ì¹œêµ¬ ì„ íƒ</option>' + options;
        }

        function updateProfilePics() {
            const initials = currentUser.substring(0, 2);
            document.getElementById('createProfilePic').textContent = initials;
            document.getElementById('profilePicLarge').textContent = initials;
            document.getElementById('profileName').textContent = currentUser;
        }

        function renderBirthdayBanner() {
            const nextBirthday = getNextBirthday();
            document.getElementById('birthdayBanner').innerHTML = 
                `ğŸ‚ ${nextBirthday.name}ë‹˜ì˜ ìƒì¼ê¹Œì§€ ${nextBirthday.daysUntil}ì¼ ë‚¨ì•˜ì–´ìš”!`;
        }

        function switchTab(tabName) {
            // ë„¤ë¹„ê²Œì´ì…˜ í™œì„±í™”
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // ì»¨í…ì¸  í‘œì‹œ
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');

            // íƒ­ë³„ ì—…ë°ì´íŠ¸
            if (tabName === 'ranking') {
                renderRanking();
            } else if (tabName === 'profile') {
                renderProfile();
            }
        }

        function selectPostType(type) {
            selectedPostType = type;
            
            // ë²„íŠ¼ í™œì„±í™”
            document.querySelectorAll('.type-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-type="${type}"]`).classList.add('active');

            // ë§Œë‚¨ ì„ íƒê¸° í‘œì‹œ/ìˆ¨ê¹€
            const meetingSelector = document.getElementById('meetingSelector');
            if (type === 'meeting') {
                meetingSelector.classList.add('active');
                document.getElementById('postContent').placeholder = 'ì˜¤ëŠ˜ ëˆ„êµ¬ì™€ ë§Œë‚¬ë‚˜ìš”? ì–´ë–¤ ì‹œê°„ì„ ë³´ë‚´ì…¨ë‚˜ìš”?';
            } else {
                meetingSelector.classList.remove('active');
                document.getElementById('postContent').placeholder = 'ì˜¤ëŠ˜ ì–´ë–¤ í•˜ë£¨ë¥¼ ë³´ë‚´ì…¨ë‚˜ìš”?';
            }
        }

        function previewImage(input) {
            const file = input.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                currentImageData = e.target.result;
                document.getElementById('imagePreview').innerHTML = `
                    <div class="image-preview">
                        <img src="${currentImageData}" class="preview-img" alt="ë¯¸ë¦¬ë³´ê¸°">
                        <button class="remove-img" onclick="removeImage()">&times;</button>
                    </div>
                `;
            };
            reader.readAsDataURL(file);
        }

        function removeImage() {
            currentImageData = null;
            document.getElementById('imagePreview').innerHTML = '';
            document.getElementById('imageInput').value = '';
        }

        function createPost() {
            const content = document.getElementById('postContent').value.trim();
            
            if (!content) {
                alert('ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }

            if (selectedPostType === 'meeting') {
                const partner = document.getElementById('meetingPartner').value;
                if (!partner) {
                    alert('ë§Œë‚œ ì¹œêµ¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!');
                    return;
                }
            }

            const post = {
                id: Date.now(),
                author: currentUser,
                content: content,
                type: selectedPostType,
                partner: selectedPostType === 'meeting' ? document.getElementById('meetingPartner').value : null,
                image: currentImageData,
                likes: [],
                date: new Date().toISOString()
            };

            posts.unshift(post);
            localStorage.setItem('posts', JSON.stringify(posts));

            // í¼ ì´ˆê¸°í™”
            document.getElementById('postContent').value = '';
            document.getElementById('meetingPartner').value = '';
            removeImage();

            renderPostFeed();
            renderRanking();
            renderProfile();
        }

        function renderPostFeed() {
            const feed = document.getElementById('postFeed');
            
            feed.innerHTML = posts.map(post => `
                <div class="post">
                    <div class="post-header">
                        <div class="post-user">
                            <div class="profile-pic">${post.author.substring(0, 2)}</div>
                            <div class="user-info">
                                <h4>${post.author}</h4>
                                <div class="post-time">${formatTimeAgo(post.date)}</div>
                            </div>
                        </div>
                        ${post.author === currentUser ? `
                            <button class="delete-btn" onclick="deletePost(${post.id})">ì‚­ì œ</button>
                        ` : ''}
                    </div>
                    
                    ${post.image ? `
                        <img src="${post.image}" class="post-image" alt="ê²Œì‹œë¬¼ ì´ë¯¸ì§€">
                    ` : ''}
                    
                    <div class="post-actions">
                        <button class="action-btn ${post.likes.includes(currentUser) ? 'liked' : ''}" 
                                onclick="toggleLike(${post.id})">
                            ${post.likes.includes(currentUser) ? 'â¤ï¸' : 'ğŸ¤'}
                        </button>
                        <button class="action-btn" onclick="openCreateModal()">ğŸ’¬</button>
                        <button class="action-btn">ğŸ“¤</button>
                    </div>
                    
                    ${post.likes.length > 0 ? `
                        <div class="post-likes" onclick="showLikes(${post.id})">
                            ì¢‹ì•„ìš” ${post.likes.length}ê°œ
                        </div>
                    ` : ''}
                    
                    <div class="post-content">
                        <span class="username">${post.author}</span>
                        ${post.type === 'meeting' && post.partner ? 
                            `<span style="color: #405de6;">@${post.partner}</span>ì™€ í•¨ê»˜ ` : ''}
                        ${post.content}
                        ${post.type === 'meeting' ? ' ğŸ‘¥' : ' ğŸ“'}
                    </div>
                </div>
            `).join('');
        }

        function toggleLike(postId) {
            const post = posts.find(p => p.id === postId);
            if (!post) return;

            const likeIndex = post.likes.indexOf(currentUser);
            if (likeIndex > -1) {
                post.likes.splice(likeIndex, 1);
            } else {
                post.likes.push(currentUser);
            }

            localStorage.setItem('posts', JSON.stringify(posts));
            renderPostFeed();
            renderProfile();
        }

        function deletePost(postId) {
            const post = posts.find(p => p.id === postId);
            if (!post) return;

            if (post.author !== currentUser) {
                alert('ìì‹ ì˜ ê²Œì‹œë¬¼ë§Œ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!');
                return;
            }

            if (confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                posts = posts.filter(p => p.id !== postId);
                localStorage.setItem('posts', JSON.stringify(posts));
                renderPostFeed();
                renderProfile();
            }
        }

        function showLikes(postId) {
            const post = posts.find(p => p.id === postId);
            if (!post || post.likes.length === 0) return;

            const likesHtml = post.likes.map(user => `
                <div style="display: flex; align-items: center; gap: 12px; padding: 8px 0;">
                    <div class="profile-pic">${user.substring(0, 2)}</div>
                    <div style="font-weight: 500;">${user}</div>
                </div>
            `).join('');

            document.getElementById('likesModalBody').innerHTML = likesHtml;
            document.getElementById('likesModal').classList.add('active');
        }

        function closeLikesModal() {
            document.getElementById('likesModal').classList.remove('active');
        }

        function renderRanking() {
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            
            // ì´ë²ˆë‹¬ ë§Œë‚¨ ë­í‚¹
            const monthlyMeetings = posts.filter(post => {
                const postDate = new Date(post.date);
                return post.type === 'meeting' && 
                       postDate.getMonth() === currentMonth && 
                       postDate.getFullYear() === currentYear;
            });

            const meetingCounts = {};
            friends.forEach(friend => meetingCounts[friend.name] = 0);

            monthlyMeetings.forEach(post => {
                meetingCounts[post.author]++;
                if (post.partner) {
                    meetingCounts[post.partner]++;
                }
            });

            const meetingRanking = Object.entries(meetingCounts)
                .map(([name, count]) => ({ name, count }))
                .sort((a, b) => b.count - a.count)
                .slice(0, 10);

            // ì´ë²ˆë‹¬ ì¸ê¸°ê¸€ (ì¢‹ì•„ìš” ë§ì€ ìˆœ)
            const monthlyPosts = posts.filter(post => {
                const postDate = new Date(post.date);
                return postDate.getMonth() === currentMonth && 
                       postDate.getFullYear() === currentYear;
            });

            const popularPosts = monthlyPosts
                .sort((a, b) => b.likes.length - a.likes.length)
                .slice(0, 5);

            document.getElementById('rankingContent').innerHTML = `
                <div class="ranking-card">
                    <div class="ranking-title">ğŸ‘¥ ì´ë²ˆë‹¬ ë§Œë‚¨í‚¹ ë­í‚¹</div>
                    ${meetingRanking.map((item, index) => `
                        <div class="ranking-item">
                            <span class="rank-position">${index + 1}ìœ„</span>
                            <span>${item.name}</span>
                            <span>${item.count}ë²ˆ</span>
                        </div>
                    `).join('')}
                </div>

                <div class="ranking-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                    <div class="ranking-title">ğŸ”¥ ì´ë²ˆë‹¬ ì¸ê¸°ê¸€ TOP 5</div>
                    ${popularPosts.map((post, index) => `
                        <div class="ranking-item" style="flex-direction: column; align-items: stretch; padding: 12px 0;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <span class="rank-position">${index + 1}ìœ„</span>
                                <span>${post.author}</span>
                                <span>â¤ï¸ ${post.likes.length}</span>
                            </div>
                            <div style="font-size: 12px; opacity: 0.8; line-height: 1.3;">
                                ${post.content.length > 50 ? post.content.substring(0, 50) + '...' : post.content}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function renderProfile() {
            const userPosts = posts.filter(post => post.author === currentUser);
            const userMeetings = posts.filter(post => 
                post.type === 'meeting' && (post.author === currentUser || post.partner === currentUser)
            );
            const userLikes = posts.reduce((total, post) => {
                return total + (post.author === currentUser ? post.likes.length : 0);
            }, 0);

            document.getElementById('postCount').textContent = userPosts.length;
            document.getElementById('meetingCount').textContent = userMeetings.length;
            document.getElementById('likeCount').textContent = userLikes;

            // ë‚´ ê²Œì‹œë¬¼ í‘œì‹œ
            document.getElementById('myPosts').innerHTML = `
                <div style="padding: 16px;">
                    <h3 style="margin-bottom: 16px; text-align: center;">ë‚´ ê²Œì‹œë¬¼</h3>
                    ${userPosts.length === 0 ? `
                        <div style="text-align: center; color: #8e8e8e; margin: 40px 0;">
                            ì•„ì§ ê²Œì‹œë¬¼ì´ ì—†ì–´ìš”<br>
                            ì²« ë²ˆì§¸ ê²Œì‹œë¬¼ì„ ì‘ì„±í•´ë³´ì„¸ìš”!
                        </div>
                    ` : userPosts.map(post => `
                        <div class="post" style="margin-bottom: 16px;">
                            <div class="post-header">
                                <div class="post-user">
                                    <div class="profile-pic">${post.author.substring(0, 2)}</div>
                                    <div class="user-info">
                                        <h4>${post.author}</h4>
                                        <div class="post-time">${formatTimeAgo(post.date)}</div>
                                    </div>
                                </div>
                                <button class="delete-btn" onclick="deletePost(${post.id})">ì‚­ì œ</button>
                            </div>
                            
                            ${post.image ? `
                                <img src="${post.image}" class="post-image" alt="ê²Œì‹œë¬¼ ì´ë¯¸ì§€">
                            ` : ''}
                            
                            <div class="post-actions">
                                <button class="action-btn ${post.likes.includes(currentUser) ? 'liked' : ''}" 
                                        onclick="toggleLike(${post.id})">
                                    ${post.likes.includes(currentUser) ? 'â¤ï¸' : 'ğŸ¤'}
                                </button>
                            </div>
                            
                            ${post.likes.length > 0 ? `
                                <div class="post-likes" onclick="showLikes(${post.id})">
                                    ì¢‹ì•„ìš” ${post.likes.length}ê°œ
                                </div>
                            ` : ''}
                            
                            <div class="post-content">
                                <span class="username">${post.author}</span>
                                ${post.type === 'meeting' && post.partner ? 
                                    `<span style="color: #405de6;">@${post.partner}</span>ì™€ í•¨ê»˜ ` : ''}
                                ${post.content}
                                ${post.type === 'meeting' ? ' ğŸ‘¥' : ' ğŸ“'}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function openCreateModal() {
            // í¬ìŠ¤íŠ¸ ì‘ì„± ì˜ì—­ìœ¼ë¡œ ìŠ¤í¬ë¡¤
            document.querySelector('.create-post').scrollIntoView({ 
                behavior: 'smooth',
                block: 'center'
            });
            document.getElementById('postContent').focus();
        }

        function showProfile() {
            switchTab('profile');
        }

        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
        function formatBirthday(birthday) {
            const date = new Date(birthday);
            return `${date.getMonth() + 1}ì›” ${date.getDate()}ì¼`;
        }

        function getDaysUntilBirthday(birthday) {
            const today = new Date();
            const birthDate = new Date(birthday);
            birthDate.setFullYear(today.getFullYear());
            
            if (birthDate < today) {
                birthDate.setFullYear(today.getFullYear() + 1);
            }
            
            const diffTime = birthDate - today;
            return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        }

        function getNextBirthday() {
            return friends
                .map(friend => ({
                    ...friend,
                    daysUntil: getDaysUntilBirthday(friend.birthday)
                }))
                .sort((a, b) => a.daysUntil - b.daysUntil)[0];
        }

        function formatTimeAgo(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffTime = now - date;
            const diffMinutes = Math.floor(diffTime / (1000 * 60));
            const diffHours = Math.floor(diffTime / (1000 * 60 * 60));
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffMinutes < 1) {
                return 'ë°©ê¸ˆ ì „';
            } else if (diffMinutes < 60) {
                return `${diffMinutes}ë¶„ ì „`;
            } else if (diffHours < 24) {
                return `${diffHours}ì‹œê°„ ì „`;
            } else if (diffDays === 1) {
                return 'ì–´ì œ';
            } else if (diffDays < 7) {
                return `${diffDays}ì¼ ì „`;
            } else {
                return `${date.getMonth() + 1}ì›” ${date.getDate()}ì¼`;
            }
        }

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ì‹œ ë‹«ê¸°
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal')) {
                e.target.classList.remove('active');
            }
        });

        // í‚¤ë³´ë“œ ESCë¡œ ëª¨ë‹¬ ë‹«ê¸°
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.classList.remove('active');
                });
            }
        });
    </script>
</body>
</html>
