<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>14Î™ÖÏùò Î†àÏ†ÑÎìú ÏπúÍµ¨Îì§ üçª</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
            padding-bottom: 80px;
        }

        /* Î©îÏù∏ Ïä§ÌÅ¨Î¶∞ */
        .main-screen {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
        }

        .main-title {
            font-size: 2.5rem;
            font-weight: 900;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #f093fb);
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradient 3s ease infinite;
            margin-bottom: 1rem;
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .main-subtitle {
            font-size: 1.1rem;
            color: white;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        .enter-btn {
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: 700;
            border: none;
            border-radius: 50px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .enter-btn:active {
            transform: scale(0.95);
        }

        /* Î©îÏù∏ Ïª®ÌÖåÏù¥ÎÑà */
        .container {
            display: none;
            padding: 20px 15px;
            max-width: 100%;
            margin: 0 auto;
        }

        .container.active {
            display: block;
        }

        /* ÏÉÅÎã® ÎÑ§ÎπÑ */
        .top-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 15px 20px;
            z-index: 1000;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            display: none;
        }

        .top-nav.active {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.2rem;
            font-weight: 700;
            color: #333;
        }

        .menu-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* ÌïòÎã® ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 10px 0;
            border-top: 1px solid rgba(0,0,0,0.1);
            z-index: 1000;
            display: none;
        }

        .bottom-nav.active {
            display: block;
        }

        .nav-items {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px 12px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.75rem;
            color: #666;
        }

        .nav-item.active {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }

        .nav-item .icon {
            font-size: 1.2rem;
            margin-bottom: 2px;
        }

        /* ÏÑπÏÖò Ïä§ÌÉÄÏùº */
        .section {
            display: none;
            margin-top: 70px;
            margin-bottom: 20px;
        }

        .section.active {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: white;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        /* Ïπ¥Îìú Ïä§ÌÉÄÏùº */
        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            backdrop-filter: blur(20px);
        }

        /* ÏπúÍµ¨ Î¶¨Ïä§Ìä∏ */
        .friends-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .friend-item {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .friend-item:active {
            transform: scale(0.95);
        }

        .friend-emoji {
            font-size: 2.5rem;
            margin-bottom: 8px;
            display: block;
        }

        .friend-name {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .friend-status {
            font-size: 0.7rem;
            opacity: 0.8;
        }

        /* Ïà†ÏπúÍµ¨ ÏÑπÏÖò */
        .drink-section {
            margin-bottom: 25px;
        }

        .drink-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .drink-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
        }

        .add-drink-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 8px 15px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
        }

        .drink-log {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .drink-date {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 8px;
        }

        .drink-participants {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 10px;
        }

        .participant-tag {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .drink-photo {
            width: 100%;
            max-height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin-top: 10px;
        }

        /* ÏõîÍ∞Ñ ÌÜµÍ≥Ñ */
        .monthly-stats {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 15px;
            padding: 20px;
            color: white;
            margin-bottom: 20px;
        }

        .stats-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            text-align: center;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .stat-item {
            background: rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.8rem;
            opacity: 0.9;
        }

        /* Îû≠ÌÇπ */
        .ranking-list {
            background: white;
            border-radius: 15px;
            overflow: hidden;
        }

        .ranking-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        .ranking-item:last-child {
            border-bottom: none;
        }

        .rank-number {
            font-size: 1.2rem;
            font-weight: 700;
            color: #ff6b6b;
            width: 30px;
        }

        .rank-emoji {
            font-size: 1.5rem;
            margin: 0 10px;
        }

        .rank-info {
            flex: 1;
        }

        .rank-name {
            font-weight: 600;
            margin-bottom: 2px;
        }

        .rank-count {
            font-size: 0.8rem;
            color: #666;
        }

        /* Í∞§Îü¨Î¶¨ */
        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .photo-item {
            aspect-ratio: 1;
            background: #f0f0f0;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            overflow: hidden;
        }

        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-placeholder {
            font-size: 1.5rem;
            color: #ccc;
        }

        /* ÏûÖÎ†• Ìèº */
        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
            font-size: 0.9rem;
        }

        .input-group input,
        .input-group textarea,
        .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 1rem;
            background: white;
        }

        .input-group input:focus,
        .input-group textarea:focus,
        .input-group select:focus {
            outline: none;
            border-color: #4ecdc4;
        }

        /* ÏπúÍµ¨ ÏÑ†ÌÉù Ï≤¥ÌÅ¨Î∞ïÏä§ */
        .friend-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }

        .friend-checkbox {
            display: flex;
            align-items: center;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .friend-checkbox.selected {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
        }

        .friend-checkbox input[type="checkbox"] {
            display: none;
        }

        .friend-checkbox .emoji {
            margin-right: 8px;
            font-size: 1.2rem;
        }

        .friend-checkbox .name {
            font-size: 0.8rem;
            font-weight: 500;
        }

        /* Î≤ÑÌäº */
        .btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
        }

        .btn:active {
            transform: scale(0.98);
        }

        /* ÌååÏùº ÏóÖÎ°úÎìú */
        .file-upload {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .file-upload input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-upload-label {
            display: block;
            padding: 15px;
            background: #f8f9fa;
            border: 2px dashed #ddd;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-upload-label:hover {
            background: #e9ecef;
            border-color: #4ecdc4;
        }

        .file-upload-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #ccc;
        }

        .file-upload-text {
            font-size: 0.9rem;
            color: #666;
        }

        /* Î™®Îã¨ */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            overflow-y: auto;
        }

        .modal-content {
            background: white;
            margin: 20px;
            padding: 20px;
            border-radius: 15px;
            position: relative;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .modal-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #999;
        }

        /* Î∞òÏùëÌòï */
        @media (max-width: 480px) {
            .main-title {
                font-size: 2rem;
            }
            
            .friends-list {
                grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }
        }

        /* Ïà®ÍπÄ */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- Î©îÏù∏ Ïä§ÌÅ¨Î¶∞ -->
    <div class="main-screen" id="mainScreen">
        <h1 class="main-title">üçª 14Î™ÖÏùò Î†àÏ†ÑÎìú</h1>
        <p class="main-subtitle">Ïà†ÏπúÍµ¨Îì§Ïùò Ï∂îÏñµ Ï†ÄÏû•ÏÜå</p>
        <button class="enter-btn" onclick="enterSite()">üöÄ Îì§Ïñ¥Í∞ÄÍ∏∞</button>
    </div>

    <!-- ÏÉÅÎã® ÎÑ§ÎπÑ -->
    <div class="top-nav" id="topNav">
        <div class="logo">üçª Î†àÏ†ÑÎìú</div>
        <div id="nextBirthday" style="font-size: 0.8rem; color: #666; text-align: center; flex: 1;">
            <!-- Îã§Ïùå ÏÉùÏùº Ï†ïÎ≥¥Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
        </div>
        <button class="menu-btn" onclick="toggleMenu()">‚ò∞</button>
    </div>

    <!-- Î©îÏù∏ Ïª®ÌÖåÏù¥ÎÑà -->
    <div class="container" id="mainContainer">
        
        <!-- Ïà†ÏπúÍµ¨ ÏÑπÏÖò -->
        <div id="drinking" class="section active">
            <h2 class="section-title">üçª Ïà†ÏπúÍµ¨ Î°úÍ∑∏</h2>
            
            <!-- Ïù¥Î≤àÎã¨ ÌÜµÍ≥Ñ -->
            <div class="monthly-stats">
                <h3 class="stats-title">üèÜ Ïù¥Î≤àÎã¨ Ïà†ÏπúÍµ¨ ÏàúÏúÑ</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-number" id="myDrinkCount">0</div>
                        <div class="stat-label">ÎÇ¥ ÏùåÏ£º ÌöüÏàò</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="topDrinkerCount">0</div>
                        <div class="stat-label">ÏùåÏ£ºÌÇπ Í∏∞Î°ù</div>
                    </div>
                </div>
            </div>

            <!-- Îû≠ÌÇπ -->
            <div class="card">
                <h3 style="margin-bottom: 15px; font-size: 1.1rem;">ü•á Ïù¥Î≤àÎã¨ ÏùåÏ£ºÌÇπ Îû≠ÌÇπ</h3>
                <div class="ranking-list" id="drinkingRanking">
                    <!-- Îû≠ÌÇπÏù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>
            </div>

            <!-- ÏµúÍ∑º Ïà†ÏπúÍµ¨ Î°úÍ∑∏ -->
            <div class="card">
                <div class="drink-header">
                    <h3 class="drink-title">üìù ÏµúÍ∑º Ïà†ÏπúÍµ¨ Í∏∞Î°ù</h3>
                    <button class="add-drink-btn" onclick="openDrinkModal()">+ Ï∂îÍ∞Ä</button>
                </div>
                <div id="drinkLogs">
                    <!-- Ïà†ÏπúÍµ¨ Î°úÍ∑∏Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>
            </div>
        </div>

        <!-- ÏπúÍµ¨Îì§ ÏÑπÏÖò -->
        <div id="friends" class="section">
            <h2 class="section-title">üë• Î†àÏ†ÑÎìú Î©§Î≤ÑÎì§</h2>
            
            <!-- Ïù¥Î≤àÎã¨ ÏÉùÏùºÏûê -->
            <div class="card" style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%); color: white;">
                <h3 style="margin-bottom: 15px; text-align: center;">üéÇ Ïù¥Î≤àÎã¨ ÏÉùÏùºÏûêÎì§</h3>
                <div id="thisMonthBirthdays">
                    <!-- Ïù¥Î≤àÎã¨ ÏÉùÏùºÏûêÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>
            </div>
            
            <!-- ÏπúÍµ¨Îì§ Ï†ïÎ≥¥ -->
            <div class="card">
                <h3 style="margin-bottom: 15px;">üë• Ï†ÑÏ≤¥ Î©§Î≤Ñ</h3>
                <div class="friends-list" id="friendsList">
                    <!-- ÏπúÍµ¨Îì§Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>
            </div>
            
            <!-- Ïû¨ÎØ∏ÎÇú ÌÜµÍ≥Ñ -->
            <div class="card">
                <h3 style="margin-bottom: 15px;">üìä Ïû¨ÎØ∏ÎÇú ÌÜµÍ≥Ñ</h3>
                <div id="funStats">
                    <!-- ÌÜµÍ≥ÑÍ∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>
            </div>
            
            <!-- ÎûúÎç§ ÏπúÍµ¨ ÎΩëÍ∏∞ -->
            <div class="card" style="text-align: center;">
                <h3 style="margin-bottom: 15px;">üé≤ Ïò§ÎäòÏùò ÌîΩ! ÎûúÎç§ ÏπúÍµ¨</h3>
                <div id="randomFriend" style="font-size: 3rem; margin: 20px 0;">üéØ</div>
                <div id="randomFriendName" style="font-size: 1.2rem; font-weight: 600; margin-bottom: 15px;">Î≤ÑÌäºÏùÑ ÎàåÎü¨Î≥¥ÏÑ∏Ïöî!</div>
                <button class="btn btn-primary" onclick="pickRandomFriend()">üé≤ ÏπúÍµ¨ ÎΩëÍ∏∞!</button>
            </div>
        </div>

        // Í∞§Îü¨Î¶¨ ÏÑπÏÖò
        <div id="gallery" class="section">
            <h2 class="section-title">üì∏ Ìà¨Ìëú Í∞§Îü¨Î¶¨</h2>
            
            <div class="card">
                <div class="drink-header">
                    <h3 class="drink-title">üèÜ ÏÇ¨ÏßÑ Ìà¨Ìëú Îû≠ÌÇπ</h3>
                    <button class="add-drink-btn" onclick="openGalleryPhotoModal()">+ ÏÇ¨ÏßÑ Ï∂îÍ∞Ä</button>
                </div>
                <div id="voteGallery">
                    <!-- Ìà¨Ìëú ÏÇ¨ÏßÑÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>
            </div>
        </div>

        <!-- ÎûúÎç§ Í≤åÏûÑ ÏÑπÏÖò -->
        <div id="random" class="section">
            <h2 class="section-title">üé≤ ÎûúÎç§ Í≤åÏûÑÏ°¥</h2>
            
            <!-- ÎûúÎç§ Ï∂îÏñµ -->
            <div class="card">
                <div class="random-box">
                    <h3 style="margin-bottom: 1rem;">üé∞ ÎûúÎç§ Ï∂îÏñµ Î®∏Ïã†</h3>
                    <div class="random-photo" id="randomPhoto">üé≤</div>
                    <p id="randomDescription" style="font-size: 1.2rem; margin-bottom: 2rem;">Î≤ÑÌäºÏùÑ ÎàåÎü¨ÏÑú Ï∂îÏñµÏùÑ ÎΩëÏïÑÎ≥¥ÏÑ∏Ïöî!</p>
                    <button class="btn btn-primary" onclick="getRandomMemory()">üé≤ Ï∂îÏñµ ÎΩëÍ∏∞!</button>
                </div>
            </div>
            
            <!-- Ïò§ÎäòÏùò Ïö¥ÏÑ∏ -->
            <div class="card">
                <h3 style="margin-bottom: 15px; text-align: center;">üîÆ Ïò§ÎäòÏùò ÏπúÍµ¨ Ïö¥ÏÑ∏</h3>
                <div class="input-group">
                    <label>ÏπúÍµ¨ ÏÑ†ÌÉù:</label>
                    <select id="fortuneSelect">
                        <option value="">ÏπúÍµ¨Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                    </select>
                </div>
                <div id="fortuneResult" style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 15px; margin-top: 15px; display: none;">
                    <!-- Ïö¥ÏÑ∏ Í≤∞Í≥ºÍ∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>
                <button class="btn btn-secondary" onclick="getFortune()">üîÆ Ïö¥ÏÑ∏ Î≥¥Í∏∞</button>
            </div>
            
            <!-- Î∞∏Îü∞Ïä§ Í≤åÏûÑ -->
            <div class="card">
                <h3 style="margin-bottom: 15px; text-align: center;">‚öñÔ∏è Î∞∏Îü∞Ïä§ Í≤åÏûÑ</h3>
                <div id="balanceGame" style="text-align: center;">
                    <button class="btn btn-primary" onclick="startBalanceGame()">üéØ ÏÉàÎ°úÏö¥ Î∞∏Îü∞Ïä§ Í≤åÏûÑ ÏãúÏûë!</button>
                </div>
            </div>
        </div>
        
        <!-- Î™ÖÏñ∏Ïßë ÏÑπÏÖò -->
        <div id="quotes" class="section">
            <h2 class="section-title">üí¨ Î†àÏ†ÑÎìú Î™ÖÏñ∏Ïßë</h2>
            
            <div class="card" id="quotesList">
                <!-- Î™ÖÏñ∏Îì§Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
            </div>
            
            <button class="btn btn-primary" onclick="openQuoteModal()">üí¨ Î™ÖÏñ∏ Ï∂îÍ∞Ä</button>
        </div>
    </div>

    <!-- ÌïòÎã® ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò -->
    <div class="bottom-nav" id="bottomNav">
        <div class="nav-items">
            <div class="nav-item active" onclick="showSection('drinking')">
                <span class="icon">üçª</span>
                <span>Ïà†ÏπúÍµ¨</span>
            </div>
            <div class="nav-item" onclick="showSection('friends')">
                <span class="icon">üéÇ</span>
                <span>ÏπúÍµ¨Îì§</span>
            </div>
            <div class="nav-item" onclick="showSection('gallery')">
                <span class="icon">üì∏</span>
                <span>Í∞§Îü¨Î¶¨</span>
            </div>
            <div class="nav-item" onclick="showSection('random')">
                <span class="icon">üé≤</span>
                <span>ÎûúÎç§</span>
            </div>
            <div class="nav-item" onclick="showSection('quotes')">
                <span class="icon">üí¨</span>
                <span>Î™ÖÏñ∏</span>
            </div>
        </div>
    </div>

    <!-- Ïà†ÏπúÍµ¨ Ï∂îÍ∞Ä Î™®Îã¨ -->
    <div id="drinkModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">üçª Ïà†ÏπúÍµ¨ Í∏∞Î°ù Ï∂îÍ∞Ä</h3>
                <button class="close-btn" onclick="closeDrinkModal()">&times;</button>
            </div>
            
            <div class="input-group">
                <label>ÎÇ†Ïßú:</label>
                <input type="date" id="drinkDate" />
            </div>
            
            <div class="input-group">
                <label>Ìï®Íªò ÎßàÏã† ÏπúÍµ¨Îì§:</label>
                <div class="friend-selector" id="friendSelector">
                    <!-- ÏπúÍµ¨ ÏÑ†ÌÉù Ï≤¥ÌÅ¨Î∞ïÏä§Îì§Ïù¥ Ïó¨Í∏∞Ïóê ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                </div>
            </div>
            
            <div class="input-group">
                <label>Î©îÎ™®:</label>
                <textarea id="drinkMemo" placeholder="Ïñ¥ÎîîÏÑú Î≠ò ÎßàÏÖ®ÎäîÏßÄ, Ïû¨Î∞åÏóàÎçò Ïùº Îì±..."></textarea>
            </div>
            
            <div class="input-group">
                <label>ÏÇ¨ÏßÑ Ï∂îÍ∞Ä:</label>
                <div class="file-upload">
                    <input type="file" id="drinkPhoto" accept="image/*" onchange="previewDrinkPhoto()" />
                    <label for="drinkPhoto" class="file-upload-label">
                        <div class="file-upload-icon">üì∑</div>
                        <div class="file-upload-text">ÏÇ¨ÏßÑÏùÑ ÏÑ†ÌÉùÌïòÍ±∞ÎÇò Ïó¨Í∏∞Ïóê ÎìúÎ°≠ÌïòÏÑ∏Ïöî</div>
                    </label>
                </div>
                <div id="drinkPhotoPreview" class="hidden">
                    <img id="drinkPhotoImg" style="width: 100%; max-height: 200px; object-fit: cover; border-radius: 10px; margin-top: 10px;" />
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="addDrinkLog()">üçª Í∏∞Î°ùÌïòÍ∏∞</button>
        </div>
    </div>

        <!-- Ìà¨Ìëú Í∞§Îü¨Î¶¨ ÏÇ¨ÏßÑ Ï∂îÍ∞Ä Î™®Îã¨ -->
    <div id="galleryPhotoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">üì∏ Ìà¨Ìëú ÏÇ¨ÏßÑ Ï∂îÍ∞Ä</h3>
                <button class="close-btn" onclick="closeGalleryPhotoModal()">&times;</button>
            </div>
            
            <div class="input-group">
                <label>ÏÇ¨ÏßÑ Ï†úÎ™©:</label>
                <input type="text" id="galleryPhotoTitle" placeholder="Ïû¨Î∞åÎäî Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî!" />
            </div>
            
            <div class="input-group">
                <label>ÏÇ¨ÏßÑ:</label>
                <div class="file-upload">
                    <input type="file" id="votePhoto" accept="image/*" onchange="previewVotePhoto()" />
                    <label for="votePhoto" class="file-upload-label">
                        <div class="file-upload-icon">üì∑</div>
                        <div class="file-upload-text">Ìà¨ÌëúÏö© ÏÇ¨ÏßÑÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</div>
                    </label>
                </div>
                <div id="votePhotoPreview" class="hidden">
                    <img id="votePhotoImg" style="width: 100%; max-height: 200px; object-fit: cover; border-radius: 10px; margin-top: 10px;" />
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="addVotePhoto()">üó≥Ô∏è Ìà¨Ìëú ÏÇ¨ÏßÑ Ï∂îÍ∞Ä</button>
        </div>
    </div>

    <!-- ÏπúÍµ¨ ÏÇ¨ÏßÑ Ï∂îÍ∞Ä Î™®Îã¨ -->
    <div id="friendPhotoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">üì∏ ÏπúÍµ¨ ÏÇ¨ÏßÑ Ï∂îÍ∞Ä</h3>
                <button class="close-btn" onclick="closeFriendPhotoModal()">&times;</button>
            </div>
            
            <div class="input-group">
                <label>ÏπúÍµ¨ ÏÑ†ÌÉù:</label>
                <select id="selectedFriendForPhoto">
                    <option value="">ÏπúÍµ¨Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                </select>
            </div>
            
            <div class="input-group">
                <label>ÏÇ¨ÏßÑ Ï†úÎ™©:</label>
                <input type="text" id="friendPhotoTitle" placeholder="ÏÇ¨ÏßÑ ÏÑ§Î™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" />
            </div>
            
            <div class="input-group">
                <label>ÏÇ¨ÏßÑ:</label>
                <div class="file-upload">
                    <input type="file" id="friendPhoto" accept="image/*" onchange="previewFriendPhoto()" />
                    <label for="friendPhoto" class="file-upload-label">
                        <div class="file-upload-icon">üì∑</div>
                        <div class="file-upload-text">ÏπúÍµ¨ ÏÇ¨ÏßÑÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</div>
                    </label>
                </div>
                <div id="friendPhotoPreview" class="hidden">
                    <img id="friendPhotoImg" style="width: 100%; max-height: 200px; object-fit: cover; border-radius: 10px; margin-top: 10px;" />
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="addFriendPhoto()">üì∏ ÏÇ¨ÏßÑ Ï∂îÍ∞Ä</button>
        </div>
    </div>

    <!-- Î™ÖÏñ∏ Ï∂îÍ∞Ä Î™®Îã¨ -->
    <div id="quoteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">üí¨ Î™ÖÏñ∏ Ï∂îÍ∞Ä</h3>
                <button class="close-btn" onclick="closeQuoteModal()">&times;</button>
            </div>
            
            <div class="input-group">
                <label>Î™ÖÏñ∏:</label>
                <textarea id="quoteText" placeholder="Î†àÏ†ÑÎìú Î∞úÏñ∏ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî..."></textarea>
            </div>
            
            <div class="input-group">
                <label>Î∞úÏñ∏Ïûê:</label>
                <select id="quoteSpeaker">
                    <option value="">ÏπúÍµ¨ ÏÑ†ÌÉù</option>
                </select>
            </div>
            
            <button class="btn btn-primary" onclick="addQuote()">üí¨ Ï∂îÍ∞ÄÌïòÍ∏∞</button>
        </div>
    </div>

    <script>
        // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•ÏÜå (Î©îÎ™®Î¶¨ Î∞©Ïãù - Ïã§Ï†ú Î∞∞Ìè¨ÏãúÏóêÎäî localStorage ÏÇ¨Ïö©)
        let friendsData = [];
        let drinkLogs = [];
        let votePhotos = []; // Ìà¨ÌëúÏö© ÏÇ¨ÏßÑÎì§
        let friendPhotos = []; // ÏπúÍµ¨Î≥Ñ ÏÇ¨ÏßÑÎì§
        let quotes = [];
        
        // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• Ìï®ÏàòÎì§ (Ïã§Ï†ú Î∞∞Ìè¨ÏãúÏóêÎäî localStorage ÏÇ¨Ïö©)
        function saveData() {
            try {
                localStorage.setItem('friendsData', JSON.stringify(friendsData));
                localStorage.setItem('drinkLogs', JSON.stringify(drinkLogs));
                localStorage.setItem('votePhotos', JSON.stringify(votePhotos));
                localStorage.setItem('friendPhotos', JSON.stringify(friendPhotos));
                localStorage.setItem('quotes', JSON.stringify(quotes));
            } catch(e) {
                // localStorage ÏÇ¨Ïö© Î∂àÍ∞ÄÏãú Î¨¥Ïãú (ÌòÑÏû¨ ÌôòÍ≤Ω)
                console.log('localStorage ÏÇ¨Ïö© Î∂àÍ∞Ä - Î©îÎ™®Î¶¨ÏóêÎßå Ï†ÄÏû•Îê©ÎãàÎã§');
            }
        }
        
        function loadData() {
            try {
                friendsData = JSON.parse(localStorage.getItem('friendsData')) || [];
                drinkLogs = JSON.parse(localStorage.getItem('drinkLogs')) || [];
                votePhotos = JSON.parse(localStorage.getItem('votePhotos')) || [];
                friendPhotos = JSON.parse(localStorage.getItem('friendPhotos')) || [];
                quotes = JSON.parse(localStorage.getItem('quotes')) || [];
            } catch(e) {
                // localStorage ÏÇ¨Ïö© Î∂àÍ∞ÄÏãú Í∏∞Î≥∏Í∞í Ïú†ÏßÄ
                console.log('localStorage ÏÇ¨Ïö© Î∂àÍ∞Ä - Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞Î°ú ÏãúÏûëÌï©ÎãàÎã§');
            }
        }

        // Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            loadData(); // Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏãúÎèÑ
            initializeFriends();
            loadDrinkLogs();
            loadVoteGallery();
            loadFriendPhotos();
            loadQuotes();
            updateRanking();
            updateThisMonthBirthdays();
            updateFunStats();
            
            // Ïö¥ÏÑ∏ ÏÖÄÎ†âÌä∏ Î∞ïÏä§ ÏóÖÎç∞Ïù¥Ìä∏
            updateSelects();
            
            // Ïò§Îäò ÎÇ†Ïßú ÏÑ§Ï†ï
            document.getElementById('drinkDate').value = new Date().toISOString().split('T')[0];
        });initializeFriends();
            loadDrinkLogs();
            loadVoteGallery();
            loadFriendPhotos();
            loadQuotes();
            updateRanking();
            
            // Ïò§Îäò ÎÇ†Ïßú ÏÑ§Ï†ï
            document.getElementById('drinkDate').value = new Date().toISOString().split('T')[0];
        });

        // ÏÇ¨Ïù¥Ìä∏ ÏßÑÏûÖ
        function enterSite() {
            document.getElementById('mainScreen').style.display = 'none';
            document.getElementById('mainContainer').classList.add('active');
            document.getElementById('topNav').classList.add('active');
            document.getElementById('bottomNav').classList.add('active');
        }

        // ÌôàÏúºÎ°ú ÎèåÏïÑÍ∞ÄÍ∏∞
        function goHome() {
            document.getElementById('mainScreen').style.display = 'flex';
            document.getElementById('mainContainer').classList.remove('active');
            document.getElementById('topNav').classList.remove('active');
            document.getElementById('bottomNav').classList.remove('active');
        }

        // ÏÑπÏÖò Ï†ÑÌôò
        function showSection(sectionName) {
            // Î™®Îì† ÏÑπÏÖò Ïà®Í∏∞Í∏∞
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Î™®Îì† ÎÑ§ÎπÑ ÏïÑÏù¥ÌÖú ÎπÑÌôúÏÑ±Ìôî
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // ÏÑ†ÌÉùÎêú ÏÑπÏÖò Î≥¥Ïù¥Í∏∞
            document.getElementById(sectionName).classList.add('active');
            
            // Ìï¥Îãπ ÎÑ§ÎπÑ ÏïÑÏù¥ÌÖú ÌôúÏÑ±Ìôî
            event.target.closest('.nav-item').classList.add('active');
            
            // ÌäπÏ†ï ÏÑπÏÖòÎ≥Ñ Ï∂îÍ∞Ä Î°úÏßÅ
            if (sectionName === 'friends') {
                updateThisMonthBirthdays();
                updateFunStats();
            }
        }

        // ÏπúÍµ¨ Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî
        function initializeFriends() {
            if (friendsData.length === 0) {
                const realFriends = [
                    { id: 1, nickname: 'YSN JOKER', emoji: 'üÉè', realName: 'Í∞ïÏ†ïÌòÑ', birthday: '0807' },
                    { id: 2, nickname: 'Î≥µÏø†Î†à', emoji: 'üé≤', realName: 'Î≥µÏßÄÌòÑ', birthday: '0115' },
                    { id: 3, nickname: 'Í∞ÅÌï¥ÌÇπ(ÏàôÏ£º)', emoji: 'ü¶†', realName: 'Í≥ΩÎèÑÏú§', birthday: '0731' },
                    { id: 4, nickname: 'ÎÖ∏ÏÜåÎß®', emoji: 'üéØ', realName: 'Ïã¨Ïû¨ÌòÑ', birthday: '1005' },
                    { id: 5, nickname: 'ÏæåÍ±∏Í∑ºÏú°Îß®', emoji: 'üí™', realName: 'ÏñëÍ∑úÌòÑ', birthday: '0419' },
                    { id: 6, nickname: '26ÎÖÑ 4Ïõî', emoji: 'üìÖ', realName: 'Ïù¥ÌïôÏ§Ä', birthday: '0222' },
                    { id: 7, nickname: 'Ìù¨Ï§ÄÏïÑ ÎÑàÎßå ÎØøÎäîÎã§', emoji: 'üôè', realName: 'ÌïúÌù¨Ï§Ä', birthday: '1221' },
                    { id: 8, nickname: 'ÎàÑÍµ¨ÏÑ∏Ïöî', emoji: '‚ùì', realName: 'Ï†ÑÏÉÅÌòÅ', birthday: '0818' },
                    { id: 9, nickname: 'ÎØ∏ÎÇòÎ¶¨', emoji: 'üåø', realName: 'ÏñëÏ†ïÌõÑ', birthday: '1018' },
                    { id: 10, nickname: 'Ìô©ÎåÄÌëú', emoji: 'üëî', realName: 'Ìô©ÏäπÌïò', birthday: '0711' },
                    { id: 11, nickname: 'Ï≤†Íµ¨', emoji: 'üî©', realName: 'Ïù¥ÏÑúÌòÑ', birthday: '0124' },
                    { id: 12, nickname: 'Í∞ïÏàúÍ±¥', emoji: 'üèóÔ∏è', realName: 'Í∞ïÏàúÍ±¥', birthday: '0418' },
                    { id: 13, nickname: 'Ïú§Ìù¨ÌÉú', emoji: 'üåü', realName: 'Ïú§Ìù¨ÌÉú', birthday: '0115' },
                    { id: 14, nickname: 'Î∞ïÏ£ºÌò∏', emoji: '‚öΩ', realName: 'Î∞ïÏ£ºÌò∏', birthday: '0601' },
                    { id: 15, nickname: 'Ïã†ÎØºÌò∏', emoji: 'üé≠', realName: 'Ïã†ÎØºÌò∏', birthday: '0303' }
                ];
                
                friendsData = realFriends;
                saveData(); // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
            }
            
            loadFriends();
            generateFriendSelector();
            updateSelects();
            updateNextBirthday();
        }

        // ÏπúÍµ¨ Î™©Î°ù Î°úÎìú
        function loadFriends() {
            const container = document.getElementById('friendsList');
            container.innerHTML = '';
            
            friendsData.forEach(friend => {
                const friendElement = document.createElement('div');
                friendElement.className = 'friend-item';
                friendElement.onclick = () => showFriendDetails(friend.id);
                
                // ÏÉùÏùºÍπåÏßÄ ÎÇ®ÏùÄ ÏùºÏàò Í≥ÑÏÇ∞
                const daysUntilBirthday = getDaysUntilBirthday(friend.birthday);
                
                friendElement.innerHTML = `
                    <span class="friend-emoji">${friend.emoji}</span>
                    <div class="friend-name">${friend.nickname}</div>
                    <div class="friend-status">ÏÉùÏùºÍπåÏßÄ ${daysUntilBirthday}Ïùº</div>
                `;
                
                container.appendChild(friendElement);
            });
        }

        // ÏÉùÏùºÍπåÏßÄ ÎÇ®ÏùÄ ÏùºÏàò Í≥ÑÏÇ∞
        function getDaysUntilBirthday(birthday) {
            const today = new Date();
            const currentYear = today.getFullYear();
            const month = parseInt(birthday.substring(0, 2)) - 1; // 0-based month
            const day = parseInt(birthday.substring(2, 4));
            
            let birthdayThisYear = new Date(currentYear, month, day);
            
            // Ïò¨Ìï¥ ÏÉùÏùºÏù¥ ÏßÄÎÇ¨ÏúºÎ©¥ ÎÇ¥ÎÖÑ ÏÉùÏùºÎ°ú Í≥ÑÏÇ∞
            if (birthdayThisYear < today) {
                birthdayThisYear = new Date(currentYear + 1, month, day);
            }
            
            const diffTime = birthdayThisYear - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            return diffDays;
        }

        // Îã§Ïùå ÏÉùÏùº ÏóÖÎç∞Ïù¥Ìä∏
        function updateNextBirthday() {
            const nextBirthdayContainer = document.getElementById('nextBirthday');
            
            // Î™®Îì† ÏπúÍµ¨Îì§Ïùò ÏÉùÏùºÍπåÏßÄ ÎÇ®ÏùÄ ÏùºÏàò Í≥ÑÏÇ∞
            const birthdayList = friendsData.map(friend => ({
                ...friend,
                daysUntil: getDaysUntilBirthday(friend.birthday)
            })).sort((a, b) => a.daysUntil - b.daysUntil);
            
            const nextBirthday = birthdayList[0];
            
            if (nextBirthday.daysUntil === 0) {
                nextBirthdayContainer.innerHTML = `üéâ Ïò§ÎäòÏùÄ ${nextBirthday.nickname}Ïùò ÏÉùÏùº! üéÇ`;
                nextBirthdayContainer.style.color = '#ff6b6b';
                nextBirthdayContainer.style.fontWeight = '600';
            } else {
                nextBirthdayContainer.innerHTML = `üéÇ Îã§Ïùå ÏÉùÏùº: ${nextBirthday.nickname} (${nextBirthday.daysUntil}Ïùº ÌõÑ)`;
            }
        }

        // Ïù¥Î≤àÎã¨ ÏÉùÏùºÏûê ÏóÖÎç∞Ïù¥Ìä∏
        function updateThisMonthBirthdays() {
            const container = document.getElementById('thisMonthBirthdays');
            const currentMonth = new Date().getMonth() + 1; // 1-based month
            
            const thisMonthBirthdays = friendsData.filter(friend => {
                const friendMonth = parseInt(friend.birthday.substring(0, 2));
                return friendMonth === currentMonth;
            });
            
            if (thisMonthBirthdays.length === 0) {
                container.innerHTML = '<p style="text-align: center; margin: 0;">Ïù¥Î≤àÎã¨ÏóêÎäî ÏÉùÏùºÏûêÍ∞Ä ÏóÜÏñ¥Ïöî! üéà</p>';
            } else {
                container.innerHTML = thisMonthBirthdays.map(friend => {
                    const day = parseInt(friend.birthday.substring(2, 4));
                    const daysUntil = getDaysUntilBirthday(friend.birthday);
                    return `
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.2);">
                            <span>${friend.emoji} ${friend.nickname}</span>
                            <span>${currentMonth}Ïõî ${day}Ïùº ${daysUntil === 0 ? '(Ïò§Îäò!)' : `(${daysUntil}Ïùº ÌõÑ)`}</span>
                        </div>
                    `;
                }).join('');
            }
        }

        // Ïû¨ÎØ∏ÎÇú ÌÜµÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏
        function updateFunStats() {
            const container = document.getElementById('funStats');
            
            const stats = [
                `üçª Ï¥ù Ïà†ÏûêÎ¶¨ ÌöüÏàò: ${drinkLogs.length}Ìöå`,
                `üì∏ ÏóÖÎ°úÎìúÎêú ÏÇ¨ÏßÑ: ${votePhotos.length + friendPhotos.length}Ïû•`,
                `üí¨ Î™ÖÏñ∏ Î™®Ïùå: ${quotes.length}Í∞ú`,
                `üéÇ ÌèâÍ∑† ÎÇòÏù¥: ${calculateAverageAge()}ÏÑ∏`,
                `üèÜ ÏµúÎã§ Ïà†ÏπúÍµ¨: ${getMostDrinkingFriend()}`
            ];
            
            container.innerHTML = stats.map(stat => 
                `<div style="padding: 8px 0; border-bottom: 1px solid #eee;">${stat}</div>`
            ).join('');
        }

        // ÌèâÍ∑† ÎÇòÏù¥ Í≥ÑÏÇ∞ (ÎåÄÎûµÏ†ÅÏúºÎ°ú)
        function calculateAverageAge() {
            // ÏÉùÎÖÑÏùÑ ÎåÄÎûµÏ†ÅÏúºÎ°ú Ï∂îÏ†ï (01ÎÖÑÏÉù = 2001ÎÖÑÏÉùÏúºÎ°ú Í∞ÄÏ†ï)
            const ages = friendsData.map(friend => {
                const birthYear = parseInt(friend.birthday.substring(0, 2));
                const year = birthYear < 50 ? 2000 + birthYear : 1900 + birthYear;
                return new Date().getFullYear() - year;
            });
            
            return Math.round(ages.reduce((sum, age) => sum + age, 0) / ages.length);
        }

        // ÏµúÎã§ Ïà†ÏπúÍµ¨ Ï∞æÍ∏∞
        function getMostDrinkingFriend() {
            if (drinkLogs.length === 0) return "ÏïÑÏßÅ ÏóÜÏùå";
            
            const drinkCounts = {};
            drinkLogs.forEach(log => {
                log.participants.forEach(friendId => {
                    drinkCounts[friendId] = (drinkCounts[friendId] || 0) + 1;
                });
            });
            
            const topDrinkerId = Object.keys(drinkCounts).reduce((a, b) => 
                drinkCounts[a] > drinkCounts[b] ? a : b
            );
            
            const topDrinker = friendsData.find(f => f.id == topDrinkerId);
            return topDrinker ? `${topDrinker.nickname} (${drinkCounts[topDrinkerId]}Ìöå)` : "ÏïÑÏßÅ ÏóÜÏùå";
        }

        // ÎûúÎç§ ÏπúÍµ¨ ÎΩëÍ∏∞
        function pickRandomFriend() {
            const randomFriend = friendsData[Math.floor(Math.random() * friendsData.length)];
            document.getElementById('randomFriend').textContent = randomFriend.emoji;
            document.getElementById('randomFriendName').textContent = `Ïò§ÎäòÏùò ÌîΩ! ${randomFriend.nickname}`;
        }

        // Ïö¥ÏÑ∏ Î≥¥Í∏∞
        function getFortune() {
            const selectedFriendId = document.getElementById('fortuneSelect').value;
            if (!selectedFriendId) {
                alert('ÏπúÍµ¨Î•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî!');
                return;
            }
            
            const friend = friendsData.find(f => f.id == selectedFriendId);
            const fortunes = [
                'Ïò§ÎäòÏùÄ Ïà†ÏûêÎ¶¨ÏóêÏÑú ÎåÄÎ∞ï ÌÑ∞Ïßà ÏòàÏ†ï! üçª',
                'ÏπúÍµ¨Îì§Í≥ºÏùò ÎßåÎÇ®ÏóêÏÑú ÌñâÏö¥Ïù¥ Ï∞æÏïÑÏò¨ Í±∞ÏòàÏöî! ‚ú®',
                'ÏÇ¨ÏßÑ Ï∞çÏùÑ Îïå Í∞ÅÎèÑ ÎåÄÎ∞ï ÎÇòÏò¨ ÎÇ†! üì∏',
                'Ïò§ÎäòÏùÄ ÏßëÏóêÏÑú Ïâ¨Îäî Í≤å Ï¢ãÍ≤†Ïñ¥Ïöî... üè†',
                'ÏÉàÎ°úÏö¥ Î™ÖÏñ∏Ïù¥ ÌÉÑÏÉùÌï† ÏòàÍ∞ê! üí¨',
                'ÏπòÌÇ®Ïù¥ ÏÉùÍ∞ÅÎÇòÎäî ÎÇ†Ïù¥ÎÑ§Ïöî! üçó',
                'ÏπúÍµ¨Îì§ÏóêÍ≤å Ïù∏Í∏∞ Ìè≠Î∞úÌï† ÏòàÏ†ï! üî•',
                'Ïû¨Î∞åÎäî ÏùºÏù¥ ÏùºÏñ¥ÎÇ† Í≤É Í∞ôÏïÑÏöî! üéâ',
                'Ïò§ÎäòÏùÄ Ï¢Ä Ï°∞Ïö©Ìûà ÏßÄÎÇ¥ÏÑ∏Ïöî... üòÖ',
                'Îü≠ÌÇ§Ìïú ÌïòÎ£®Í∞Ä Îê† Í±∞ÏòàÏöî! üçÄ'
            ];
            
            const randomFortune = fortunes[Math.floor(Math.random() * fortunes.length)];
            const fortuneContainer = document.getElementById('fortuneResult');
            
            fortuneContainer.innerHTML = `
                <div style="font-size: 2rem; margin-bottom: 10px;">${friend.emoji}</div>
                <div style="font-weight: 600; margin-bottom: 10px;">${friend.nickname}Ïùò Ïò§Îäò Ïö¥ÏÑ∏</div>
                <div style="font-size: 1.1rem; color: #666;">${randomFortune}</div>
            `;
            fortuneContainer.style.display = 'block';
        }

        // Î∞∏Îü∞Ïä§ Í≤åÏûÑ
        function startBalanceGame() {
            const games = [
                ['üç∫ Îß•Ï£º vs üç∂ ÏÜåÏ£º', 'Îß•Ï£º', 'ÏÜåÏ£º'],
                ['üè† Ïßë vs üéâ ÌÅ¥ÎüΩ', 'Ïßë', 'ÌÅ¥ÎüΩ'],
                ['üçó ÏπòÌÇ® vs üçï ÌîºÏûê', 'ÏπòÌÇ®', 'ÌîºÏûê'],
                ['üò¥ ÏùºÏ∞ç ÏûêÍ∏∞ vs üåô Ïò¨ÎÇòÏù¥Ìä∏', 'ÏùºÏ∞ç ÏûêÍ∏∞', 'Ïò¨ÎÇòÏù¥Ìä∏'],
                ['üí∞ Îèà vs ‚ù§Ô∏è ÏÇ¨Îûë', 'Îèà', 'ÏÇ¨Îûë'],
                ['‚òÄÔ∏è Ïó¨Î¶Ñ vs ‚ùÑÔ∏è Í≤®Ïö∏', 'Ïó¨Î¶Ñ', 'Í≤®Ïö∏'],
                ['üéÆ Í≤åÏûÑ vs üì∫ ÏòÅÌôî', 'Í≤åÏûÑ', 'ÏòÅÌôî'],
                ['üöó ÎìúÎùºÏù¥Î∏å vs üö∂ ÏÇ∞Ï±Ö', 'ÎìúÎùºÏù¥Î∏å', 'ÏÇ∞Ï±Ö']
            ];
            
            const randomGame = games[Math.floor(Math.random() * games.length)];
            const gameContainer = document.getElementById('balanceGame');
            
            gameContainer.innerHTML = `
                <h4 style="margin-bottom: 20px; color: #333;">${randomGame[0]}</h4>
                <div style="display: flex; gap: 10px; justify-content: center;">
                    <button class="btn btn-primary" onclick="selectBalance('${randomGame[1]}')" style="flex: 1; max-width: 120px;">${randomGame[1]}</button>
                    <button class="btn btn-secondary" onclick="selectBalance('${randomGame[2]}')" style="flex: 1; max-width: 120px;">${randomGame[2]}</button>
                </div>
                <div id="balanceResult" style="margin-top: 15px; font-size: 0.9rem; color: #666;"></div>
            `;
        }

        // Î∞∏Îü∞Ïä§ Í≤åÏûÑ ÏÑ†ÌÉù
        function selectBalance(choice) {
            const messages = [
                `${choice} ÏÑ†ÌÉù! Ïó≠Ïãú ÏÑºÏä§ ÏûàÎÑ§Ïöî! üëç`,
                `${choice}Î•º Í≥†Î•¥Îã§Îãà... ÏòàÏÉÅÌñàÏñ¥Ïöî! üòÑ`,
                `${choice} ÌååÏù¥ÌÑ∞ÏãúÍµ∞Ïöî! üî•`,
                `${choice}... Í∑∏Îü¥ Ï§Ñ ÏïåÏïòÏñ¥Ïöî! üòè`
            ];
            
            const randomMessage = messages[Math.floor(Math.random() * messages.length)];
            document.getElementById('balanceResult').textContent = randomMessage;
            
            setTimeout(() => {
                document.getElementById('balanceGame').innerHTML = '<button class="btn btn-primary" onclick="startBalanceGame()">üéØ ÏÉàÎ°úÏö¥ Î∞∏Îü∞Ïä§ Í≤åÏûÑ ÏãúÏûë!</button>';
            }, 3000);
        }

        // ÏπúÍµ¨Î≥Ñ Ïà†ÏπúÍµ¨ ÌöüÏàò Í≥ÑÏÇ∞
        function getDrinkCountForFriend(friendId) {
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            
            return drinkLogs.filter(log => {
                const logDate = new Date(log.date);
                return logDate.getMonth() === currentMonth && 
                       logDate.getFullYear() === currentYear &&
                       log.participants.includes(friendId);
            }).length;
        }

        // ÏπúÍµ¨ ÏÑ†ÌÉùÍ∏∞ ÏÉùÏÑ±
        function generateFriendSelector() {
            const container = document.getElementById('friendSelector');
            container.innerHTML = '';
            
            friendsData.forEach(friend => {
                const friendOption = document.createElement('div');
                friendOption.className = 'friend-checkbox';
                friendOption.onclick = () => toggleFriendSelection(friend.id);
                
                friendOption.innerHTML = `
                    <input type="checkbox" id="friend_${friend.id}" value="${friend.id}">
                    <span class="emoji">${friend.emoji}</span>
                    <span class="name">${friend.nickname}</span>
                `;
                
                container.appendChild(friendOption);
            });
        }

        // ÏπúÍµ¨ ÏÑ†ÌÉù ÌÜ†Í∏Ä
        function toggleFriendSelection(friendId) {
            const checkbox = document.getElementById(`friend_${friendId}`);
            const container = checkbox.parentElement;
            
            checkbox.checked = !checkbox.checked;
            container.classList.toggle('selected', checkbox.checked);
        }

        // ÏÖÄÎ†âÌä∏ Î∞ïÏä§ ÏóÖÎç∞Ïù¥Ìä∏
        function updateSelects() {
            const selects = ['quoteSpeaker', 'friendPhotoSelect', 'selectedFriendForPhoto', 'fortuneSelect'];
            
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (!select) return;
                
                const currentValue = select.value;
                
                // Í∏∞Ï°¥ ÏòµÏÖò Ï†úÍ±∞ (Ï≤´ Î≤àÏß∏ ÏòµÏÖò Ï†úÏô∏)
                while(select.children.length > 1) {
                    select.removeChild(select.lastChild);
                }
                
                // ÏπúÍµ¨Îì§ Ï∂îÍ∞Ä
                friendsData.forEach(friend => {
                    const option = document.createElement('option');
                    option.value = friend.id;
                    option.textContent = friend.nickname;
                    select.appendChild(option);
                });
                
                select.value = currentValue;
            });
        }

        // Ìà¨Ìëú Í∞§Îü¨Î¶¨ ÏÇ¨ÏßÑ Î™®Îã¨ Ïó¥Í∏∞
        function openGalleryPhotoModal() {
            document.getElementById('galleryPhotoModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        // Ìà¨Ìëú Í∞§Îü¨Î¶¨ ÏÇ¨ÏßÑ Î™®Îã¨ Îã´Í∏∞
        function closeGalleryPhotoModal() {
            document.getElementById('galleryPhotoModal').style.display = 'none';
            document.body.style.overflow = 'auto';
            resetVotePhotoForm();
        }

        // Ìà¨Ìëú ÏÇ¨ÏßÑ Ìèº Î¶¨ÏÖã
        function resetVotePhotoForm() {
            document.getElementById('galleryPhotoTitle').value = '';
            document.getElementById('votePhoto').value = '';
            document.getElementById('votePhotoPreview').classList.add('hidden');
        }

        // Ìà¨Ìëú ÏÇ¨ÏßÑ ÎØ∏Î¶¨Î≥¥Í∏∞
        function previewVotePhoto() {
            const file = document.getElementById('votePhoto').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('votePhotoImg').src = e.target.result;
                    document.getElementById('votePhotoPreview').classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        }

        // Ìà¨Ìëú ÏÇ¨ÏßÑ Ï∂îÍ∞Ä
        function addVotePhoto() {
            const title = document.getElementById('galleryPhotoTitle').value;
            const photoFile = document.getElementById('votePhoto').files[0];
            
            if (!title || !photoFile) {
                alert('Ï†úÎ™©Í≥º ÏÇ¨ÏßÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const newVotePhoto = {
                    id: Date.now(),
                    title: title,
                    photo: e.target.result,
                    votes: 0,
                    voters: [], // Ï§ëÎ≥µ Ìà¨Ìëú Î∞©ÏßÄ
                    timestamp: new Date().toISOString()
                };
                
                votePhotos.unshift(newVotePhoto);
                saveData();
                
                loadVoteGallery();
                closeGalleryPhotoModal();
            };
            reader.readAsDataURL(photoFile);
        }

        // Ìà¨Ìëú Í∞§Îü¨Î¶¨ Î°úÎìú
        function loadVoteGallery() {
            const container = document.getElementById('voteGallery');
            container.innerHTML = '';
            
            if (votePhotos.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #999; padding: 20px;">Ìà¨ÌëúÌï† ÏÇ¨ÏßÑÏù¥ ÏóÜÏñ¥Ïöî! Ï≤´ ÏÇ¨ÏßÑÏùÑ Ïò¨Î†§Î≥¥ÏÑ∏Ïöî üì∏</p>';
                return;
            }
            
            // Ìà¨ÌëúÏàúÏúºÎ°ú Ï†ïÎ†¨
            const sortedPhotos = [...votePhotos].sort((a, b) => b.votes - a.votes);
            
            sortedPhotos.forEach((photo, index) => {
                const photoElement = document.createElement('div');
                photoElement.className = 'drink-log';
                photoElement.style.background = index === 0 ? 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)' : 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                photoElement.style.color = 'white';
                photoElement.style.position = 'relative';
                
                photoElement.innerHTML = `
                    <div style="position: absolute; top: 10px; right: 10px; background: rgba(255,0,0,0.8); color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 1rem; z-index: 10;" onclick="deleteVotePhoto(${photo.id})" title="ÏÇ≠Ï†ú">‚úï</div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; padding-right: 45px;">
                        <h4 style="margin: 0;">${index + 1}ÏúÑ. ${photo.title}</h4>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="font-weight: 600;">‚ù§Ô∏è ${photo.votes}</span>
                            <button onclick="votePhoto(${photo.id})" style="background: rgba(255,255,255,0.2); border: none; border-radius: 15px; padding: 5px 12px; color: white; font-size: 0.8rem; cursor: pointer;">Ìà¨Ìëú</button>
                        </div>
                    </div>
                    <img src="${photo.photo}" style="width: 100%; max-height: 250px; object-fit: cover; border-radius: 10px; cursor: pointer;" onclick="viewPhoto('${photo.photo}', '${photo.title}')">
                    <div style="text-align: right; font-size: 0.7rem; opacity: 0.8; margin-top: 5px;">
                        ${new Date(photo.timestamp).toLocaleDateString('ko-KR')}
                    </div>
                `;
                
                container.appendChild(photoElement);
            });
        }

        // Ìà¨Ìëú ÏÇ¨ÏßÑ ÏÇ≠Ï†ú
        function deleteVotePhoto(photoId) {
            if (confirm('Ï†ïÎßê Ïù¥ Ìà¨Ìëú ÏÇ¨ÏßÑÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†Ïñ¥Ïöî?')) {
                votePhotos = votePhotos.filter(photo => photo.id !== photoId);
                saveData();
                loadVoteGallery();
            }
        }

        // ÏÇ¨ÏßÑ Ìà¨Ìëú
        function votePhoto(photoId) {
            const photo = votePhotos.find(p => p.id === photoId);
            if (photo) {
                // Í∞ÑÎã®Ìïú Ï§ëÎ≥µ Ìà¨Ìëú Î∞©ÏßÄ (Ïã§Ï†úÎ°úÎäî ÏÇ¨Ïö©Ïûê ID Í∏∞Î∞òÏúºÎ°ú Ìï¥Ïïº Ìï®)
                const voterId = 'user1'; // ÏûÑÏãú ÏÇ¨Ïö©Ïûê ID
                if (photo.voters.includes(voterId)) {
                    alert('Ïù¥ÎØ∏ Ìà¨ÌëúÌïòÏÖ®ÏäµÎãàÎã§!');
                    return;
                }
                
                photo.votes += 1;
                photo.voters.push(voterId);
                saveData();
                loadVoteGallery();
            }
        }

        // ÏπúÍµ¨ ÏÇ¨ÏßÑ Î™®Îã¨ Ïó¥Í∏∞
        function openFriendPhotoModal() {
            const selectedFriend = document.getElementById('friendPhotoSelect').value;
            if (!selectedFriend) {
                alert('Î®ºÏ†Ä ÏπúÍµ¨Î•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî!');
                return;
            }
            
            document.getElementById('selectedFriendForPhoto').value = selectedFriend;
            document.getElementById('friendPhotoModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        // ÏπúÍµ¨ ÏÇ¨ÏßÑ Î™®Îã¨ Îã´Í∏∞
        function closeFriendPhotoModal() {
            document.getElementById('friendPhotoModal').style.display = 'none';
            document.body.style.overflow = 'auto';
            resetFriendPhotoForm();
        }

        // ÏπúÍµ¨ ÏÇ¨ÏßÑ Ìèº Î¶¨ÏÖã
        function resetFriendPhotoForm() {
            document.getElementById('friendPhotoTitle').value = '';
            document.getElementById('friendPhoto').value = '';
            document.getElementById('friendPhotoPreview').classList.add('hidden');
        }

        // ÏπúÍµ¨ ÏÇ¨ÏßÑ ÎØ∏Î¶¨Î≥¥Í∏∞
        function previewFriendPhoto() {
            const file = document.getElementById('friendPhoto').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('friendPhotoImg').src = e.target.result;
                    document.getElementById('friendPhotoPreview').classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        }

        // ÏπúÍµ¨ ÏÇ¨ÏßÑ Ï∂îÍ∞Ä
        function addFriendPhoto() {
            const friendId = document.getElementById('selectedFriendForPhoto').value;
            const title = document.getElementById('friendPhotoTitle').value;
            const photoFile = document.getElementById('friendPhoto').files[0];
            
            if (!friendId || !title || !photoFile) {
                alert('Î™®Îì† Ï†ïÎ≥¥Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const newFriendPhoto = {
                    id: Date.now(),
                    friendId: parseInt(friendId),
                    title: title,
                    photo: e.target.result,
                    timestamp: new Date().toISOString()
                };
                
                friendPhotos.unshift(newFriendPhoto);
                saveData();
                
                loadFriendPhotos();
                closeFriendPhotoModal();
            };
            reader.readAsDataURL(photoFile);
        }

        // ÏπúÍµ¨ ÏÇ¨ÏßÑÎì§ Î°úÎìú
        function loadFriendPhotos() {
            const selectedFriend = document.getElementById('friendPhotoSelect')?.value;
            const container = document.getElementById('friendPhotoGallery');
            
            if (!container) return;
            
            container.innerHTML = '';
            
            if (!selectedFriend) {
                container.innerHTML = '<p style="text-align: center; color: #999; padding: 20px;">ÏπúÍµ¨Î•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî!</p>';
                return;
            }
            
            const friendFacePhotos = friendPhotos.filter(photo => photo.friendId == selectedFriend);
            
            if (friendFacePhotos.length === 0) {
                const friend = friendsData.find(f => f.id == selectedFriend);
                container.innerHTML = `<p style="text-align: center; color: #999; padding: 20px;">${friend?.nickname}Ïùò ÏÇ¨ÏßÑÏù¥ ÏóÜÏñ¥Ïöî!</p>`;
                return;
            }
            
            const gridContainer = document.createElement('div');
            gridContainer.className = 'photo-grid';
            
            friendFacePhotos.forEach(photo => {
                const photoElement = document.createElement('div');
                photoElement.className = 'photo-item';
                photoElement.style.position = 'relative';
                
                photoElement.innerHTML = `
                    <img src="${photo.photo}" alt="${photo.title}" onclick="viewPhoto('${photo.photo}', '${photo.title}')">
                    <div style="position: absolute; top: 5px; right: 5px; background: rgba(255,0,0,0.8); color: white; border-radius: 50%; width: 25px; height: 25px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 0.8rem;" onclick="deleteFriendPhoto(${photo.id})" title="ÏÇ≠Ï†ú">‚úï</div>
                    <div style="position: absolute; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.7); color: white; padding: 5px; font-size: 0.7rem; text-align: center;">${photo.title}</div>
                `;
                gridContainer.appendChild(photoElement);
            });
            
            container.appendChild(gridContainer);
        }

        // ÏπúÍµ¨ ÏÇ¨ÏßÑ ÏÇ≠Ï†ú
        function deleteFriendPhoto(photoId) {
            if (confirm('Ï†ïÎßê Ïù¥ ÏÇ¨ÏßÑÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†Ïñ¥Ïöî?')) {
                friendPhotos = friendPhotos.filter(photo => photo.id !== photoId);
                saveData();
                loadFriendPhotos();
            }
        }

        // ÏπúÍµ¨ ÏÑ†ÌÉùÏãú ÏÇ¨ÏßÑ Î°úÎìú
        function loadSelectedFriendPhotos() {
            loadFriendPhotos();
        }

        // Í∏∞Ï°¥ Ìï®ÏàòÎì§ ÏóÖÎç∞Ïù¥Ìä∏

        // Ïà†ÏπúÍµ¨ Î™®Îã¨ Ïó¥Í∏∞
        function openDrinkModal() {
            document.getElementById('drinkModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        // Ïà†ÏπúÍµ¨ Î™®Îã¨ Îã´Í∏∞
        function closeDrinkModal() {
            document.getElementById('drinkModal').style.display = 'none';
            document.body.style.overflow = 'auto';
            resetDrinkForm();
        }

        // Ïà†ÏπúÍµ¨ Ìèº Î¶¨ÏÖã
        function resetDrinkForm() {
            document.getElementById('drinkDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('drinkMemo').value = '';
            document.getElementById('drinkPhoto').value = '';
            document.getElementById('drinkPhotoPreview').classList.add('hidden');
            
            // ÏπúÍµ¨ ÏÑ†ÌÉù Î¶¨ÏÖã
            document.querySelectorAll('.friend-checkbox').forEach(item => {
                item.classList.remove('selected');
                item.querySelector('input').checked = false;
            });
        }

        // Ïà†ÏπúÍµ¨ ÏÇ¨ÏßÑ ÎØ∏Î¶¨Î≥¥Í∏∞
        function previewDrinkPhoto() {
            const file = document.getElementById('drinkPhoto').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('drinkPhotoImg').src = e.target.result;
                    document.getElementById('drinkPhotoPreview').classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        }

        // Ïà†ÏπúÍµ¨ Í∏∞Î°ù Ï∂îÍ∞Ä
        function addDrinkLog() {
            const date = document.getElementById('drinkDate').value;
            const memo = document.getElementById('drinkMemo').value;
            const selectedFriends = Array.from(document.querySelectorAll('.friend-checkbox.selected input'))
                .map(input => parseInt(input.value));
            
            if (!date || selectedFriends.length === 0) {
                alert('ÎÇ†ÏßúÏôÄ ÏπúÍµ¨Î•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî!');
                return;
            }
            
            const photoFile = document.getElementById('drinkPhoto').files[0];
            let photoData = null;
            
            if (photoFile) {
                // Ïã§Ï†ú Ïï±ÏóêÏÑúÎäî ÏÑúÎ≤ÑÏóê ÏóÖÎ°úÎìúÌïòÍ≤†ÏßÄÎßå, ÏßÄÍ∏àÏùÄ base64Î°ú Ï†ÄÏû•
                const reader = new FileReader();
                reader.onload = function(e) {
                    photoData = e.target.result;
                    saveDrinkLog();
                };
                reader.readAsDataURL(photoFile);
            } else {
                saveDrinkLog();
            }
            
            function saveDrinkLog() {
                const newLog = {
                    id: Date.now(),
                    date: date,
                    participants: selectedFriends,
                    memo: memo,
                    photo: photoData,
                    timestamp: new Date().toISOString()
                };
                
                drinkLogs.unshift(newLog);
                saveData(); // localStorage ÎåÄÏã† saveData Ìï®Ïàò ÏÇ¨Ïö©
                
                loadDrinkLogs();
                updateRanking();
                loadFriends();
                updateThisMonthBirthdays();
                updateFunStats();
                closeDrinkModal();
            }
        }

        // Ïà†ÏπúÍµ¨ Î°úÍ∑∏ Î°úÎìú
        function loadDrinkLogs() {
            const container = document.getElementById('drinkLogs');
            container.innerHTML = '';
            
            if (drinkLogs.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #999; padding: 20px;">ÏïÑÏßÅ Ïà†ÏπúÍµ¨ Í∏∞Î°ùÏù¥ ÏóÜÏñ¥Ïöî! Ï≤´ Í∏∞Î°ùÏùÑ ÎÇ®Í≤®Î≥¥ÏÑ∏Ïöî üçª</p>';
                return;
            }
            
            drinkLogs.slice(0, 10).forEach(log => {
                const logElement = document.createElement('div');
                logElement.className = 'drink-log';
                logElement.style.position = 'relative';
                
                const participants = log.participants.map(id => {
                    const friend = friendsData.find(f => f.id === id);
                    return friend ? friend.nickname : 'Ïïå Ïàò ÏóÜÏùå';
                });
                
                logElement.innerHTML = `
                    <div style="position: absolute; top: 10px; right: 10px; background: rgba(255,0,0,0.8); color: white; border-radius: 50%; width: 25px; height: 25px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 0.8rem; z-index: 10;" onclick="deleteDrinkLog(${log.id})" title="ÏÇ≠Ï†ú">‚úï</div>
                    <div class="drink-date">${new Date(log.date).toLocaleDateString('ko-KR', { 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric',
                        weekday: 'short'
                    })}</div>
                    <div class="drink-participants">
                        ${participants.map(name => `<span class="participant-tag">${name}</span>`).join('')}
                    </div>
                    ${log.memo ? `<div style="margin-top: 8px; font-size: 0.9rem; padding-right: 30px;">${log.memo}</div>` : ''}
                    ${log.photo ? `<img src="${log.photo}" class="drink-photo" onclick="viewPhoto('${log.photo}')">` : ''}
                `;
                
                container.appendChild(logElement);
            });
        }

        // Ïà†ÏπúÍµ¨ Î°úÍ∑∏ ÏÇ≠Ï†ú
        function deleteDrinkLog(logId) {
            if (confirm('Ï†ïÎßê Ïù¥ Ïà†ÏπúÍµ¨ Í∏∞Î°ùÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†Ïñ¥Ïöî?')) {
                drinkLogs = drinkLogs.filter(log => log.id !== logId);
                saveData();
                loadDrinkLogs();
                updateRanking();
                loadFriends();
            }
        }

        // Îû≠ÌÇπ ÏóÖÎç∞Ïù¥Ìä∏
        function updateRanking() {
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            
            // ÏπúÍµ¨Î≥Ñ Ïà†ÏπúÍµ¨ ÌöüÏàò Í≥ÑÏÇ∞
            const drinkCounts = friendsData.map(friend => {
                const count = getDrinkCountForFriend(friend.id);
                return {
                    friend: friend,
                    count: count
                };
            }).sort((a, b) => b.count - a.count);
            
            // Îû≠ÌÇπ ÌëúÏãú
            const container = document.getElementById('drinkingRanking');
            container.innerHTML = '';
            
            drinkCounts.slice(0, 5).forEach((item, index) => {
                const rankElement = document.createElement('div');
                rankElement.className = 'ranking-item';
                
                const medals = ['ü•á', 'ü•à', 'ü•â', '4Ô∏è‚É£', '5Ô∏è‚É£'];
                
                rankElement.innerHTML = `
                    <div class="rank-number">${index + 1}</div>
                    <div class="rank-emoji">${item.friend.emoji}</div>
                    <div class="rank-info">
                        <div class="rank-name">${item.friend.nickname}</div>
                        <div class="rank-count">Ïù¥Î≤àÎã¨ ${item.count}Ìöå</div>
                    </div>
                    <div style="font-size: 1.5rem;">${medals[index] || 'üèÖ'}</div>
                `;
                
                container.appendChild(rankElement);
            });
            
            // ÌÜµÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏
            const topCount = drinkCounts[0] ? drinkCounts[0].count : 0;
            document.getElementById('topDrinkerCount').textContent = topCount;
            
            // ÎÇ¥ ÏùåÏ£º ÌöüÏàòÎäî ÏûÑÏùòÎ°ú Ï≤´ Î≤àÏß∏ ÏπúÍµ¨Î°ú ÏÑ§Ï†ï (Ïã§Ï†úÎ°úÎäî ÏÇ¨Ïö©Ïûê ÏÑ§Ï†ï ÌïÑÏöî)
            document.getElementById('myDrinkCount').textContent = drinkCounts[0] ? drinkCounts[0].count : 0;
        }

        // ÏÇ¨ÏßÑ Î™®Îã¨ Ïó¥Í∏∞
        function openPhotoModal() {
            document.getElementById('photoModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        // ÏÇ¨ÏßÑ Î™®Îã¨ Îã´Í∏∞
        function closePhotoModal() {
            document.getElementById('photoModal').style.display = 'none';
            document.body.style.overflow = 'auto';
            resetPhotoForm();
        }

        // ÏÇ¨ÏßÑ Ìèº Î¶¨ÏÖã
        function resetPhotoForm() {
            document.getElementById('photoTitle').value = '';
            document.getElementById('photoFriendSelect').value = '';
            document.getElementById('galleryPhoto').value = '';
            document.getElementById('galleryPhotoPreview').classList.add('hidden');
        }

        // Í∞§Îü¨Î¶¨ ÏÇ¨ÏßÑ ÎØ∏Î¶¨Î≥¥Í∏∞
        function previewGalleryPhoto() {
            const file = document.getElementById('galleryPhoto').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('galleryPhotoImg').src = e.target.result;
                    document.getElementById('galleryPhotoPreview').classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        }

        // ÏÇ¨ÏßÑ Ï∂îÍ∞Ä
        function addPhoto() {
            const title = document.getElementById('photoTitle').value;
            const friendId = document.getElementById('photoFriendSelect').value;
            const photoFile = document.getElementById('galleryPhoto').files[0];
            
            if (!title || !photoFile) {
                alert('Ï†úÎ™©Í≥º ÏÇ¨ÏßÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const newPhoto = {
                    id: Date.now(),
                    title: title,
                    friendId: friendId ? parseInt(friendId) : null,
                    photo: e.target.result,
                    timestamp: new Date().toISOString()
                };
                
                photos.unshift(newPhoto);
                saveData(); // localStorage ÎåÄÏã† saveData Ìï®Ïàò ÏÇ¨Ïö©
                
                loadPhotos();
                closePhotoModal();
            };
            reader.readAsDataURL(photoFile);
        }

        // ÏÇ¨ÏßÑ Î°úÎìú
        function loadPhotos() {
            const container = document.getElementById('photoGrid');
            container.innerHTML = '';
            
            const selectedFriend = document.getElementById('galleryFriendSelect')?.value;
            const filteredPhotos = selectedFriend ? 
                photos.filter(photo => photo.friendId == selectedFriend) : 
                photos;
            
            if (filteredPhotos.length === 0) {
                container.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: #999; padding: 20px;">ÏÇ¨ÏßÑÏù¥ ÏóÜÏñ¥Ïöî!</p>';
                return;
            }
            
            filteredPhotos.forEach(photo => {
                const photoElement = document.createElement('div');
                photoElement.className = 'photo-item';
                photoElement.onclick = () => viewPhoto(photo.photo, photo.title);
                
                photoElement.innerHTML = `<img src="${photo.photo}" alt="${photo.title}">`;
                container.appendChild(photoElement);
            });
        }

        // ÏπúÍµ¨ Í∞§Îü¨Î¶¨ Î°úÎìú
        function loadFriendGallery() {
            loadPhotos();
        }

        // ÏÇ¨ÏßÑ ÌÅ¨Í≤å Î≥¥Í∏∞
        function viewPhoto(photoSrc, title = '') {
            // Í∞ÑÎã®Ìïú ÏÇ¨ÏßÑ Î∑∞Ïñ¥ (Î™®Îã¨Î°ú Íµ¨ÌòÑ Í∞ÄÎä•)
            const newWindow = window.open('', '_blank');
            newWindow.document.write(`
                <html>
                    <head><title>${title}</title></head>
                    <body style="margin:0; background:#000; display:flex; justify-content:center; align-items:center; min-height:100vh;">
                        <img src="${photoSrc}" style="max-width:100%; max-height:100vh; object-fit:contain;">
                    </body>
                </html>
            `);
        }

        // Î™ÖÏñ∏ Î™®Îã¨ Ïó¥Í∏∞
        function openQuoteModal() {
            document.getElementById('quoteModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        // Î™ÖÏñ∏ Î™®Îã¨ Îã´Í∏∞
        function closeQuoteModal() {
            document.getElementById('quoteModal').style.display = 'none';
            document.body.style.overflow = 'auto';
            resetQuoteForm();
        }

        // Î™ÖÏñ∏ Ìèº Î¶¨ÏÖã
        function resetQuoteForm() {
            document.getElementById('quoteText').value = '';
            document.getElementById('quoteSpeaker').value = '';
        }

        // Î™ÖÏñ∏ Ï∂îÍ∞Ä
        function addQuote() {
            const text = document.getElementById('quoteText').value;
            const speakerId = document.getElementById('quoteSpeaker').value;
            
            if (!text || !speakerId) {
                alert('Î™ÖÏñ∏Í≥º Î∞úÏñ∏ÏûêÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!');
                return;
            }
            
            const speaker = friendsData.find(f => f.id == speakerId);
            
            const newQuote = {
                id: Date.now(),
                text: text,
                speaker: speaker.nickname,
                speakerId: speakerId,
                timestamp: new Date().toISOString()
            };
            
            quotes.unshift(newQuote);
            saveData(); // localStorage ÎåÄÏã† saveData Ìï®Ïàò ÏÇ¨Ïö©
            
            loadQuotes();
            closeQuoteModal();
        }

        // Î™ÖÏñ∏ Î°úÎìú
        function loadQuotes() {
            const container = document.getElementById('quotesList');
            container.innerHTML = '';
            
            if (quotes.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #999; padding: 20px;">ÏïÑÏßÅ Î™ÖÏñ∏Ïù¥ ÏóÜÏñ¥Ïöî! Ï≤´ Î™ÖÏñ∏ÏùÑ ÎÇ®Í≤®Î≥¥ÏÑ∏Ïöî üí¨</p>';
                return;
            }
            
            quotes.forEach(quote => {
                const quoteElement = document.createElement('div');
                quoteElement.className = 'drink-log';
                quoteElement.style.background = 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)';
                quoteElement.style.color = 'white';
                quoteElement.style.position = 'relative';
                
                quoteElement.innerHTML = `
                    <div style="position: absolute; top: 10px; right: 10px; background: rgba(255,0,0,0.8); color: white; border-radius: 50%; width: 25px; height: 25px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 0.8rem; z-index: 10;" onclick="deleteQuote(${quote.id})" title="ÏÇ≠Ï†ú">‚úï</div>
                    <div style="font-style: italic; font-size: 1.1rem; margin-bottom: 10px; padding-right: 35px;">
                        "${quote.text}"
                    </div>
                    <div style="text-align: right; font-weight: 600;">
                        - ${quote.speaker}
                    </div>
                    <div style="text-align: right; font-size: 0.8rem; opacity: 0.8; margin-top: 5px;">
                        ${new Date(quote.timestamp).toLocaleDateString('ko-KR')}
                    </div>
                `;
                
                container.appendChild(quoteElement);
            });
        }

        // Î™ÖÏñ∏ ÏÇ≠Ï†ú
        function deleteQuote(quoteId) {
            if (confirm('Ï†ïÎßê Ïù¥ Î™ÖÏñ∏ÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†Ïñ¥Ïöî?')) {
                quotes = quotes.filter(quote => quote.id !== quoteId);
                saveData();
                loadQuotes();
            }
        }

        // ÏπúÍµ¨ ÏÉÅÏÑ∏ Ï†ïÎ≥¥ (Ï∂îÌõÑ Íµ¨ÌòÑ)
        function showFriendDetails(friendId) {
            const friend = friendsData.find(f => f.id === friendId);
            alert(`${friend.nickname} (${friend.realName})\nÏù¥Î≤àÎã¨ Ïà†ÏπúÍµ¨ ÌöüÏàò: ${getDrinkCountForFriend(friendId)}Ìöå`);
        }

        // Î©îÎâ¥ ÌÜ†Í∏Ä (Ï∂îÌõÑ Íµ¨ÌòÑ)
        function toggleMenu() {
            // ÏÑ§Ï†ï Î©îÎâ¥ Îì± Ï∂îÍ∞Ä Í∏∞Îä•
            alert('Ï∂îÍ∞Ä Í∏∞Îä•ÏùÄ Í≥ß ÏóÖÎç∞Ïù¥Ìä∏ ÏòàÏ†ïÏûÖÎãàÎã§!');
        }

        // Î™®Îã¨ Ïô∏Î∂Ä ÌÅ¥Î¶≠Ïãú Îã´Í∏∞
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
        }
    </script>
</body>
</html>
